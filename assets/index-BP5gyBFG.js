var Mt=Object.defineProperty;var Ft=(e,t,s)=>t in e?Mt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var d=(e,t,s)=>Ft(e,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&i(n)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();(globalThis.adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-3940256099942544",enable_page_level_ads:!0});var we=class{static toArray(e){return Array.from(e)}static inArray(e,t,s){return Array.isArray(e)?e.indexOf(t,s):-1}},u=class{static getType(e){let t=typeof e;return t!=="object"?t:Array.isArray(e)?"array":"object"}static isUndefined(e){return typeof e>"u"}static isObject(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}static isFunction(e){return typeof e=="function"}static isString(e){return typeof e=="string"}static isArray(e){return Array.isArray(e)}},L={create(e){return Object.create(e||null)},extendObject(e,t){return!u.isObject(e)||!u.isObject(t)?!1:(Object.keys(e).forEach(s=>{this.hasOwnProp(t,s)||(t[s]=e[s])}),t)},clone(e){return!e||!u.isObject(e)?{}:JSON.parse(JSON.stringify(e))},getClassObject(e){return typeof e=="function"?e.prototype:e},extendClass(e,t){let s=this.getClassObject(e),i=this.getClassObject(t);if(typeof s!="object"||typeof i!="object")return!1;let r=Object.create(s);for(var a in i)r[a]=i[a];return r},hasOwnProp(e,t){return Object.prototype.hasOwnProperty.call(e,t)},isPlainObject(e){return!!e&&Object.prototype.toString.call(e)==="[object Object]"},isEmpty(e){return u.isObject(e)?Object.keys(e).length===0:!0}},Se={types:{},add(e,t){this.types[e]=t},get(e){return this.types[e]||!1},remove(e){delete this.types[e]}},Wt=class{constructor(){this.types=new Map}add(t,s){this.types.has(t)||this.types.set(t,[]),this.types.get(t).push(s)}get(t){return this.types.get(t)||!1}has(t){return this.types.has(t)}removeByCallBack(t,s){typeof t=="function"&&t(s)}removeType(t){if(!this.types.has(t))return;let s=this.types.get(t);if(!s.length)return;let i,r=Se.get(t);if(r){for(var a=0,n=s.length;a<n;a++)i=s[a],i&&(s[a]=null,this.removeByCallBack(r,i));this.types.delete(t)}}remove(t){if(t){this.removeType(t);return}this.types.forEach((s,i)=>{i&&this.removeType(i)}),this.types.clear()}},oe,P=(oe=class{static addType(e,t){Se.add(e,t)}static removeType(e){Se.remove(e)}static getTrackingId(e){return e?e.trackingId||(e.trackingId=`dt${this.trackingCount++}`):""}static add(e,t,s){let i=this.getTrackingId(e);this.find(i).add(t,s)}static get(e,t){let s=e.trackingId,i=this.trackers.get(s);return i?t?i.get(t):i:!1}static has(e,t){let s=this.getTrackingId(e);if(!s)return!1;let i=this.trackers.get(s);return i&&t?i.has(t):!1}static find(e){return this.trackers.has(e)||this.trackers.set(e,new Wt),this.trackers.get(e)}static isEmpty(e){return!e||typeof e!="object"?!0:e.size===0}static remove(e,t){let s=e.trackingId;if(!s||!this.trackers.has(s))return;let i=this.trackers.get(s);if(!t){i.remove(),this.trackers.delete(s);return}i.remove(t),this.isEmpty(i.types)&&this.trackers.delete(s)}},d(oe,"trackers",new Map),d(oe,"trackingCount",0),oe),Pe=e=>{let t=0;for(let[s,i]of Object.entries(e))t++,typeof e[s]=="object"&&(t+=Pe(e[s]));return t},Qe=(e,t)=>{let s=!1;if(typeof e!="object"||typeof t!="object")return s;for(let[i,r]of Object.entries(e)){if(!L.hasOwnProp(t,i))break;let a=t[i];if(typeof r!=typeof a)break;if(typeof r=="object"){if(s=Qe(r,a),s!==!0)break}else if(r===a)s=!0;else break}return s},_t=(e,t)=>{let s=Pe(e),i=Pe(t);return s!==i?!1:Qe(e,t)},Ht=(e,t)=>{let s=typeof e;return s!==typeof t?!1:s==="object"?_t(e,t):e===t},g={getEvents(e){return u.isObject(e)===!1?[]:P.get(e,"events")},create(e,t,s,i=!1,r=!1,a=null){return r=r===!0,{event:e,obj:t,fn:s,capture:i,swapped:r,originalFn:a}},on(e,t,s,i){return Array.isArray(e)?e.forEach(r=>this.add(r,t,s,i)):this.add(e,t,s,i),this},off(e,t,s,i){return Array.isArray(e)?e.forEach(r=>this.remove(r,t,s,i)):this.remove(e,t,s,i),this},add(e,t,s,i=!1,r=!1,a=null){if(u.isObject(t)===!1)return this;let n=this.create(e,t,s,i,r,a);return P.add(t,"events",n),t.addEventListener(e,s,i),this},remove(e,t,s,i=!1){let r=this.getEvent(e,t,s,i);return r===!1?this:(typeof r=="object"&&this.removeEvent(r),this)},removeEvent(e){return typeof e=="object"&&e.obj.removeEventListener(e.event,e.fn,e.capture),this},getEvent(e,t,s,i){if(typeof t!="object")return!1;let r=this.getEvents(t);if(!r||r.length<1)return!1;let a=this.create(e,t,s,i);return this.search(a,r)},search(e,t){let s,i=this.isSwappable(e.event);for(var r=0,a=t.length;r<a;r++)if(s=t[r],!(s.event!==e.event||s.obj!==e.obj)&&(s.fn===e.fn||i===!0&&s.originalFn===e.fn))return s;return!1},removeEvents(e){return u.isObject(e)===!1?this:(P.remove(e,"events"),this)},swap:["DOMMouseScroll","wheel","mousewheel","mousemove","popstate"],addSwapped(e){this.swap.push(e)},isSwappable(e){return this.swap.includes(e)}};P.addType("events",e=>{g.removeEvent(e)});var Ut={events:g,addListener(e,t,s,i){return this.events.add(e,t,s,i),this},on(e,t,s,i){let r=this.events;return Array.isArray(e)?e.forEach(a=>{r.add(a,t,s,i)}):r.add(e,t,s,i),this},off(e,t,s,i){let r=this.events;return Array.isArray(e)?e.forEach(a=>{r.remove(a,t,s,i)}):r.remove(e,t,s,i),this},removeListener(e,t,s,i){return this.events.remove(e,t,s,i),this},_createEvent(e,t,s,i){let r;switch(t){case"HTMLEvents":r=new Event(e,s);break;case"MouseEvents":r=new MouseEvent(e,s);break;default:r=new CustomEvent(e,i);break}return r},createEvent(e,t,s,i){if(u.isObject(t)===!1)return!1;let r={pointerX:0,pointerY:0,button:0,view:window,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0,relatedTarget:null};u.isObject(s)&&(r=Object.assign(r,s));let a=this._getEventType(e);return this._createEvent(e,a,r,i)},_getEventType(e){let t={HTMLEvents:/^(?:load|unload|abort|error|select|change|submit|reset|focus|blur|resize|scroll)$/,MouseEvents:/^(?:click|dblclick|mouse(?:down|up|over|move|out))$/},s="CustomEvent";for(let[i,r]of Object.entries(t))if(e.match(r)){s=i;break}return s},trigger(e,t,s){if(u.isObject(t)===!1)return this;let i=typeof e=="string"?this.createEvent(e,t,null,s):e;return t.dispatchEvent(i),this},mouseWheelEventType:null,getWheelEventType(){let e=()=>{let t="wheel";return"onmousewheel"in self?t="mousewheel":"DOMMouseScroll"in self&&(t="DOMMouseScroll"),t};return this.mouseWheelEventType||(this.mouseWheelEventType=e())},onMouseWheel(e,t,s,i=!1){typeof t>"u"&&(t=window);let r=n=>{let o=Math.max(-1,Math.min(1,-n.deltaY||n.wheelDelta||-n.detail));typeof e=="function"&&e(o,n),s===!0&&n.preventDefault()},a=this.getWheelEventType();return this.events.add(a,t,r,i,!0,e),this},offMouseWheel(e,t,s=!1){typeof t>"u"&&(t=window);let i=this.getWheelEventType();return this.off(i,t,e,s),this},preventDefault(e){return typeof e.preventDefault=="function"?e.preventDefault():e.returnValue=!1,this},stopPropagation(e){return typeof e.stopPropagation=="function"?e.stopPropagation():e.cancelBubble=!0,this}},ke=class{constructor(){this.errors=[],this.dataTracker=P}augment(e){if(!u.isObject(e))return this;let t=this.constructor.prototype;for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return this}override(e,t,s,i){return(e[t]=s).apply(e,we.toArray(i))}getLastError(){let e=this.errors;return e.length?e.pop():!1}addError(e){this.errors.push(e)}getProperty(e,t,s){if(u.isObject(e)===!1)return"";let i=e[t];return typeof i<"u"?i:typeof s<"u"?s:""}createCallBack(e,t,s=[],i=!1){return typeof t!="function"?!1:(...r)=>(i===!0&&(s=s.concat(r)),t.apply(e,s))}bind(e,t){return t.bind(e)}};ke.prototype.extend=(function(){return ke.prototype})();var Z=new ke;Z.augment({...L,...Ut,...u,equals:Ht});var xe={url:"",responseType:"json",method:"POST",fixedParams:"",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},beforeSend:[],async:!0,crossDomain:!1,withCredentials:!1,completed:null,failed:null,aborted:null,progress:null},$t=()=>{Z.augment({xhrSettings:xe,addFixedParams(e){this.xhrSettings.fixedParams=e},beforeSend(e){this.xhrSettings.beforeSend.push(e)},ajaxSettings(e){typeof e=="object"&&(this.xhrSettings=L.extendClass(Z.xhrSettings,e))},resetAjaxSettings(){this.xhrSettings=xe}})},z=class{static limit(e,t=1e6){return typeof e!="string"?"":e.substring(0,t)}static parseQueryString(e,t,s=!0){typeof e!="string"&&(e=window.location.search),e=this.limit(e);let i={},r=/([^?=&]+)(=([^&]*))?/g;return e.replace(r,function(a,n,o,c){i[n]=t!==!1?decodeURIComponent(c):c}),i}static camelCase(e){e=this.limit(e);let t=/(-|\s|_)+\w{1}/g;return e.replace(t,s=>s[1].toUpperCase())}static uncamelCase(e,t="-"){e=this.limit(e);let s=/([A-Z]{1,})/g;return e.replace(s,i=>t+i.toLowerCase()).toLowerCase()}static titleCase(e){if(!e)return"";e=this.limit(e);let t=/\w\S*/;return e.replace(t,s=>s.charAt(0).toUpperCase()+s.substring(1).toLowerCase())}},Xt=class{constructor(t){this.settings=null,this.xhr=null,this.setup(t)}setup(t){this.getXhrSettings(t);let s=this.xhr=this.createXHR(),{method:i,url:r,async:a}=this.settings;s.open(i,r,a),this.setupHeaders(),this.addXhrEvents(),this.beforeSend(),s.send(this.getParams())}beforeSend(){let t=xe.beforeSend;if(t.length<1)return;let s=this.xhr,i=this.settings;for(var r=0,a=t.length;r<a;r++){var n=t[r];n&&n(s,i)}}objectToString(t){let s=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&s.push(i+"="+encodeURIComponent(t[i]));return s.join("&")}setupParams(t,s){let i=typeof t;if(!s)return!(t instanceof FormData)&&i==="object"&&(t=this.objectToString(t)),t;let r=typeof s;if(i==="string")return r!=="string"&&(s=this.objectToString(s)),t+=(t===""?"?":"&")+s,t;if(r==="string"&&(s=z.parseQueryString(s,!1)),t instanceof FormData)for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&t.append(a,s[a]);else i==="object"&&(t=L.clone(t),t=Object.assign(s,t),t=this.objectToString(t));return t}getParams(){let t=this.settings,s=t.fixedParams,i=t.params;return i?i=this.setupParams(i,s):s&&(i=this.setupParams(s)),i}getXhrSettings(t){let s=this.settings={...Z.xhrSettings};if(t.length>=2&&typeof t[0]!="object")for(var i=0,r=t.length;i<r;i++){var a=t[i];switch(i){case 0:s.url=a;break;case 1:s.params=a;break;case 2:s.completed=a,s.failed=a;break;case 3:s.responseType=a||"json";break;case 4:s.method=a?a.toUpperCase():"POST";break;case 5:s.async=typeof a<"u"?a:!0;break}}else s=this.settings=L.extendClass(this.settings,t[0]),typeof s.completed=="function"&&(typeof s.failed!="function"&&(s.failed=s.completed),typeof s.aborted!="function"&&(s.aborted=s.failed))}createXHR(){let t=this.settings,s=new XMLHttpRequest;return s.responseType=t.responseType,t.withCredentials===!0&&(s.withCredentials=!0),s}setupHeaders(){let t=this.settings;if(!t&&typeof t.headers!="object")return;let s=t.headers;for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&this.xhr.setRequestHeader(i,s[i])}update(t,s){let i=this.xhr,r=()=>{g.removeEvents(i.upload),g.removeEvents(i)},a=this.settings;if(!a)return!1;switch(s||t.type){case"load":if(typeof a.completed=="function"){let n=this.getResponseData();a.completed(n,this.xhr)}r();break;case"error":typeof a.failed=="function"&&a.failed(!1,this.xhr),r();break;case"progress":typeof a.progress=="function"&&a.progress(t);break;case"abort":typeof a.aborted=="function"&&a.aborted(!1,this.xhr),r();break}}getResponseData(){let t=this.xhr,s=t.responseType;return!s||s==="text"?t.responseText:t.response}addXhrEvents(){if(!this.settings)return;let t=this.xhr,s=this.update.bind(this);g.on(["load","error","abort"],t,s),g.on("progress",t.upload,s)}};$t();var Ze=(...e)=>new Xt(e).xhr,Yt=e=>typeof e!="string"?e:et(e),et=e=>[{tag:"text",textContent:e}],tt=()=>({props:{},children:[]}),st=e=>({props:{},children:et(e)}),it=e=>({props:{},children:e}),rt=e=>({props:e[0]||{},children:Yt(e[1])}),Gt=class{constructor(){this.connections=new Map}add(e,t,s){return this.find(e).set(t,s),s}get(e,t){let s=this.connections.get(e);return s&&s.get(t)||!1}find(e){let t=this.connections.get(e);if(t)return t;let s=new Map;return this.connections.set(e,s),s}remove(e,t){let s=this.connections.get(e);if(!s)return;let i;if(t)i=s.get(t),i&&(i.unsubscribe(),s.delete(t)),s.size===0&&this.connections.delete(e);else{let r=s.values();for(let a of r)a&&a.unsubscribe();this.connections.delete(e)}}},at=class{constructor(){this.msg=null,this.token=null}setToken(e){this.token=e}},qt=class extends at{constructor(t){super(),this.data=t}subscribe(t,s){this.msg=t,this.token=this.data.on(t,s)}unsubscribe(){this.data.off(this.msg,this.token)}},nt=class{unsubscribe(){}},Vt=class extends nt{constructor(){super(),this.source=null}addSource(t){return this.source=new qt(t)}unsubscribe(){this.source.unsubscribe(),this.source=null}},lt=class extends at{constructor(e){super(),this.pubSub=e}subscribe(e){this.msg=e;let t=this.callBack.bind(this);this.token=this.pubSub.on(e,t)}unsubscribe(){this.pubSub.off(this.msg,this.token)}callBack(){}},Jt=class extends lt{constructor(e,t,s){super(s),this.data=e,this.prop=t}set(e){this.data.set(this.prop,e)}get(){return this.data.get(this.prop)}callBack(e,t){this.data!==t&&this.data.set(this.prop,e,t)}},x=class{static getById(e){return typeof e!="string"?!1:document.getElementById(e)||!1}static getByName(e){if(typeof e!="string")return!1;let t=document.getElementsByName(e);return t?we.toArray(t):!1}static getBySelector(e,t){if(typeof e!="string")return!1;if(t=t||!1,t===!0)return document.querySelector(e)||!1;let s=document.querySelectorAll(e);return s?s.length===1?s[0]:we.toArray(s):!1}static html(e,t){return u.isObject(e)===!1?!1:u.isUndefined(t)===!1?(e.innerHTML=t,this):e.innerHTML}static setCss(e,t,s){return u.isObject(e)===!1||u.isUndefined(t)?this:(t=z.uncamelCase(t),e.style[t]=s,this)}static getCss(e,t){if(!e||typeof t>"u")return!1;t=z.uncamelCase(t);let s=e.style[t];if(s!=="")return s;let i=null,r=e.currentStyle;if(r&&(i=r[t]))return i;let a=window.getComputedStyle(e,null);return a?a[t]:s}static css(e,t,s){return typeof s<"u"?(this.setCss(e,t,s),this):this.getCss(e,t)}static removeAttr(e,t){return u.isObject(e)&&e.removeAttribute(t),this}static setAttr(e,t,s){e.setAttribute(t,s)}static getAttr(e,t){return e.getAttribute(t)}static attr(e,t,s){return u.isObject(e)===!1?!1:typeof s<"u"?(this.setAttr(e,t,s),this):this.getAttr(e,t)}static _checkDataPrefix(e){return typeof e!="string"||(e=z.uncamelCase(e),e.substring(0,5)!=="data-"&&(e="data-"+e)),e}static removeDataPrefix(e){return typeof e=="string"&&e.substring(0,5)==="data-"&&(e=e.substring(5)),e}static setData(e,t,s){t=this.removeDataPrefix(t),t=z.camelCase(t),e.dataset[t]=s}static getData(e,t){return t=z.camelCase(this.removeDataPrefix(t)),e.dataset[t]}static data(e,t,s){return u.isObject(e)===!1?!1:typeof s<"u"?(this.setData(e,t,s),this):this.getData(e,t)}static find(e,t){return!e||typeof t!="string"?[]:e.querySelectorAll(t)}static show(e){if(u.isObject(e)===!1)return this;let t=this.data(e,"style-display"),s=typeof t=="string"?t:"";return this.css(e,"display",s),this}static hide(e){if(u.isObject(e)===!1)return this;let t=this.css(e,"display");return t!=="none"&&t&&this.data(e,"style-display",t),this.css(e,"display","none"),this}static toggle(e){return u.isObject(e)===!1?this:(this.css(e,"display")!=="none"?this.hide(e):this.show(e),this)}static getSize(e){return u.isObject(e)===!1?!1:{width:this.getWidth(e),height:this.getHeight(e)}}static getWidth(e){return u.isObject(e)?e.offsetWidth:!1}static getHeight(e){return u.isObject(e)?e.offsetHeight:!1}static getScrollPosition(e){let t=0,s=0;switch(typeof e){case"undefined":e=document.documentElement,t=e.scrollLeft,s=e.scrollTop;break;case"object":t=e.scrollLeft,s=e.scrollTop;break}return u.isObject(e)===!1?!1:{left:t-(e.clientLeft||0),top:s-(e.clientTop||0)}}static getScrollTop(e){return this.getScrollPosition(e).top}static getScrollLeft(e){return this.getScrollPosition(e).left}static getWindowSize(){let e=window,t=document,s=t.documentElement,i=t.getElementsByTagName("body")[0],r=e.innerWidth||s.clientWidth||i.clientWidth,a=e.innerHeight||s.clientHeight||i.clientHeight;return{width:r,height:a}}static getDocumentSize(){let e=document,t=e.body,s=e.documentElement,i=Math.max(t.scrollHeight,t.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight);return{width:Math.max(t.scrollWidth,t.offsetWidth,s.clientWidth,s.scrollWidth,s.offsetWidth),height:i}}static getDocumentHeight(){return this.getDocumentSize().height}static position(e,t=1){let s={x:0,y:0};if(u.isObject(e)===!1)return s;let i=0;for(;e&&(t===0||i<t);)i++,s.x+=e.offsetLeft+e.clientLeft,s.y+=e.offsetTop+e.clientTop,e=e.offsetParent;return s}static addClass(e,t){if(u.isObject(e)===!1||t==="")return this;if(typeof t=="string"){let r=t.split(" ");for(var s=0,i=r.length;s<i;s++)e.classList.add(t)}return this}static removeClass(e,t){return u.isObject(e)===!1||t===""?this:(typeof t>"u"?e.className="":e.classList.remove(t),this)}static hasClass(e,t){return u.isObject(e)===!1||t===""?!1:e.classList.contains(t)}static toggleClass(e,t){return u.isObject(e)===!1?this:(e.classList.toggle(t),this)}},ot=e=>{let t="textContent";if(!e||typeof e!="object")return t;let s=e.tagName.toLowerCase();if(s==="input"||s==="textarea"||s==="select"){let i=e.type;if(!i)return t="value",t;switch(i){case"checkbox":t="checked";break;case"file":t="files";break;default:t="value"}}return t},Kt=(e,t,s)=>{x.setAttr(e,t,s)},Qt=(e,t,s)=>{e.checked=e.value==s},Zt=(e,t,s)=>{s=s==1,ct(e,t,s)},ct=(e,t,s)=>{e[t]=s},es=(e,t)=>x.getAttr(e,t),ts=(e,t)=>e[t],ss=class extends lt{constructor(e,t,s,i){super(i),this.element=e,this.attr=this.getAttrBind(t),this.addSetMethod(e,this.attr),this.filter=typeof s=="string"?this.setupFilter(s):s}addSetMethod(e,t){if(t.substring(4,1)==="-")return this.setValue=Kt,this.getValue=es,this;this.getValue=ts;let s=e.type;if(s)switch(s){case"checkbox":this.setValue=Zt;return;case"radio":this.setValue=Qt;return}return this.setValue=ct,this}getAttrBind(e){return e||ot(this.element)}setupFilter(e){let t=/(\[\[[^\]]+\]\])/;return s=>e.replace(t,s)}set(e){let t=this.element;return!t||typeof t!="object"?this:(this.filter&&(e=this.filter(e)),this.setValue(t,this.attr,e),this)}get(){let e=this.element;return!e||typeof e!="object"?"":this.getValue(e,this.attr)}callBack(e,t){return t!==this.element&&this.set(e),this}},is=class extends nt{constructor(t){super(),this.element=null,this.data=null,this.pubSub=t}addElement(t,s,i){return this.element=new ss(t,s,i,this.pubSub)}addData(t,s){return this.data=new Jt(t,s,this.pubSub)}unsubscribeSource(t){return t&&t.unsubscribe(),this}unsubscribe(){return this.unsubscribeSource(this.element),this.unsubscribeSource(this.data),this.element=null,this.data=null,this}},Me=-1,ht=class{constructor(){this.callBacks=new Map}get(t){return this.callBacks.has(t)||this.callBacks.set(t,new Map),this.callBacks.get(t)}reset(){this.callBacks.clear(),Me=-1}on(t,s){let i=(++Me).toString();return this.get(t).set(i,s),i}off(t,s){let i=this.callBacks.get(t);i&&(s=String(s),i.delete(s),i.size===0&&this.callBacks.delete(t))}remove(t){this.callBacks.delete(t)}publish(t,...s){let i=this.callBacks.get(t);if(i)for(let r of i.values())r&&r.apply(this,s)}},rs=class{constructor(){this.version="1.0.1",this.attr="bindId",this.blockedKeys=[20,37,38,39,40],this.connections=new Gt,this.pubSub=new ht,this.idCount=0,this.setup()}setup(){this.setupEvents()}bind(e,t,s,i){let r=s,a=null;if(s.indexOf(":")!==-1){let h=s.split(":");h.length>1&&(r=h[1],a=h[0])}let n=this.setupConnection(e,t,r,a,i),o=n.element,c=t.get(r);return typeof c<"u"?o.set(c):(c=o.get(),c!==""&&n.data.set(c)),this}setupConnection(e,t,s,i,r){let a=this.getBindId(e),n=new is(this.pubSub);n.addData(t,s).subscribe(a);let o=`${t.getDataId()}:${s}`;return n.addElement(e,i,r).subscribe(o),this.addConnection(a,"bind",n),n}addConnection(e,t,s){return this.connections.add(e,t,s),this}setBindId(e){let t="db-"+this.idCount++;return e.dataset&&(e.dataset[this.attr]=t),e[this.attr]=t,t}getBindId(e){return e[this.attr]||this.setBindId(e)}unbind(e){let t=e[this.attr];return t&&this.connections.remove(t),this}watch(e,t,s,i){if(u.isObject(e)===!1)return this;let r=new Vt;r.addSource(t).subscribe(s,i);let a=this.getBindId(e),n=t.getDataId()+":"+s;this.addConnection(a,n,r);let o=t.get(s);return i(o),this}unwatch(e,t,s){if(u.isObject(e)===!1)return this;let i=e[this.attr];if(i){let r=t.getDataId()+":"+s;this.connections.remove(i,r)}return this}publish(e,t,s){return this.pubSub.publish(e,t,s),this}isDataBound(e){return e&&e[this.attr]||null}isBlocked(e){return e.type!=="keyup"?!1:this.blockedKeys.indexOf(e.keyCode)!==-1}bindHandler(e){if(this.isBlocked(e))return!0;let t=e.target||e.srcElement,s=this.isDataBound(t);if(s!==null){let i=this.connections.get(s,"bind");if(i){let r=i.element.get();this.pubSub.publish(s,r,t)}}e.stopPropagation()}setupEvents(){this.changeHandler=this.bindHandler.bind(this),this.addEvents()}addEvents(){typeof document<"u"&&g.on(["change","paste","input"],document,this.changeHandler,!1)}removeEvents(){typeof document<"u"&&g.off(["change","paste","input"],document,this.changeHandler,!1)}},_=new rs,ee=e=>e.data?e.data:e.context&&e.context.data?e.context.data:e.state?e.state:null,as={class:"className",text:"textContent",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",celpadding:"cellPadding",useMap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},Ee=e=>as[e]||e,Oe=e=>typeof e=="string"&&e.substring(0,2)==="on"?e.substring(2):e,ie=class{static create(e,t,s,i){let r=document.createElement(e);return this.addAttributes(r,t),i===!0?this.prepend(s,r):this.append(s,r),r}static addAttributes(e,t){if(!t||typeof t!="object")return;let s=t.type;typeof s<"u"&&x.setAttr(e,"type",s);for(let[i,r]of Object.entries(t))i==="innerHTML"?e.innerHTML=r:i.indexOf("-")!==-1?x.setAttr(e,i,r):this.addAttr(e,i,r)}static addHtml(e,t){return typeof t>"u"||t===""?this:(/(?:<[a-z][\s\S]*>)/i.test(t)?e.innerHTML=t:e.textContent=t,this)}static addAttr(e,t,s){if(!(s===""||!t))if(typeof s=="function")t=Oe(t),g.add(t,e,s);else{let i=Ee(t);e[i]=s}}static createDocFragment(){return document.createDocumentFragment()}static createText(e,t){let s=document.createTextNode(e);return t&&this.append(t,s),s}static createComment(e,t){let s=document.createComment(e);return t&&this.append(t,s),s}static setupSelectOptions(e,t,s){if(!u.isObject(e)||!u.isArray(t))return!1;t.forEach(i=>{let r=new Option(i.label,i.value);e.options.add(r),s!==null&&r.value==s&&(r.selected=!0)})}static removeElementData(e){P.remove(e);let t=e.childNodes;if(t){let r=t.length-1;for(var s=r;s>=0;s--){var i=t[s];i&&this.removeElementData(i)}}e.bindId&&_.unbind(e)}static removeElement(e){if(!e)return this;let t=P.has(e,"manual-destroy");return this.removeElementData(e),t===!1&&e.remove(),this}static removeChild(e){return this.removeElement(e),this}static removeAll(e){if(!u.isObject(e))return this;let t=e.childNodes;for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&this.removeElementData(t[s]);return e.innerHTML="",this}static changeParent(e,t){return t.appendChild(e),this}static append(e,t){return e.appendChild(t),this}static prepend(e,t,s){let i=s||e.firstChild;return e.insertBefore(t,i),this}static clone(e,t=!1){return u.isObject(e)?e.cloneNode(t):!1}},I=class extends ie{static create(e,t,s,i){let r=document.createElement(e);return this.addAttributes(r,t,i),s.appendChild(r),r}static addAttributes(e,t,s){!t||t.length<1||t.forEach(i=>{let{key:r,value:a}=i;this.addAttr(e,r,a,s)})}static addAttr(e,t,s,i){if(s===""||!t)return;if(t==="innerHTML"){e.innerHTML=s;return}if(typeof s=="function"){t=Oe(t),g.add(t,e,function(a){s.call(this,a,i)});return}if(t.substr(4,1)==="-"){x.setAttr(e,t,s);return}let r=Ee(t);e[r]=s}static addContent(e,t){t&&(t.textContent!==null?e.textContent=t.textContent:t.innerHTML&&(e.innerHTML=t.innerHTML))}static append(e,t){e.appendChild(t)}},ue=/(\[\[(.*?(?:\[\d+\])?)\]\])/g,D={isWatching(e){return Array.isArray(e)?typeof e[0]=="string"&&this.hasParams(e[0]):this.hasParams(e)},hasParams(e){return u.isString(e)&&e.includes("[[")},_getWatcherProps(e){let t=e.match(ue);return t?t.map(s=>s.slice(2,-2)):null},updateAttr(e,t,s){switch(t){case"text":case"textContent":e.textContent=s;break;case"disabled":e.disabled=!s;break;case"checked":e.checked=!!s;break;case"required":e.required=!!s;break;case"src":if(e.tagName.toLowerCase()==="img"){e.src=s&&(s.indexOf(".")!==-1||s.indexOf("blob:")!==-1)?s:"";break}e.src=s;break;default:I.addAttr(e,t,s);break}},replaceParams(e,t,s=!1){let i=0;return e.replace(ue,function(){let r=s?t[i]:t;i++;let a=r.get(arguments[2]);return typeof a<"u"&&a!==null?a:""})},_getWatcherCallBack(e,t,s,i,r){return()=>{let a=this.replaceParams(s,t,r);this.updateAttr(e,i,a)}},getValue(e,t){let s=e.value;return Array.isArray(s)===!1?[s,ee(t)]:(s.length<2&&s.push(ee(t)),s)},getPropValues(e,t,s){let i=[];for(var r=0,a=t.length;r<a;r++){var n=s?e[r]:e,o=n.get(t[r]);o=typeof o<"u"?o:"",i.push(o)}return i},getCallBack(e,t,s,i,r){let a=e.attr||"textContent",n=e.callBack;if(typeof n=="function"){let o=i.match(ue)||[],c=o&&o.length>1;return(h,p)=>{h=c!==!0?h:this.getPropValues(s,o,r);let m=n(h,t,p);typeof m<"u"&&this.updateAttr(t,a,m)}}return this._getWatcherCallBack(t,s,i,a,r)},addDataWatcher(e,t,s){var C;let i=this.getValue(t,s),r=i[1]??(s==null?void 0:s.data)??((C=s==null?void 0:s.context)==null?void 0:C.data)??(s==null?void 0:s.state)??null;if(!r)return;let a=i[0],n=Array.isArray(r),o=this.getCallBack(t,e,r,a,n),c=this._getWatcherProps(a);for(var h=0,p=c.length;h<p;h++){var m=n?r[h]:r;this.addWatcher(e,m,c[h],o)}},getWatcherSettings(e,t=null){if(typeof e=="string")return{attr:t,value:e};if(Array.isArray(e)){let s=e[e.length-1];s&&typeof s=="object"&&(s=t!==null?t:null);let i=e[1]&&typeof e[1]=="object"?[e[0],e[1]]:[e[0]];return typeof s=="function"?{attr:t,value:i,callBack:s}:{attr:s||"textContent",value:i}}return e},setup(e,t,s){t&&this.addDataWatcher(e,this.getWatcherSettings(t),s)},addWatcher(e,t,s,i){_.watch(e,t,s,i)}},ns=e=>({props:{watch:e},children:[]}),ls=e=>{if(!e)return tt();let t=e[0];if(typeof t=="string")return st(t);if(Array.isArray(t))return D.isWatching(t)===!1?it(t):ns(t);let s=e[1]??e[0]??[];return s&&Array.isArray(s)&&D.isWatching(s)===!0&&(e[0]=Array.isArray(e[0])?{}:e[0],e[0].watch=s,e[1]=[]),rt(e)},f=e=>(...t)=>{let{props:s,children:i}=ls(t);return e(s,i)};function Fe(e,t){let s=isNaN(Number(t)),i=s?t:`[${t}]`;return e===""?i:s?`${e}.${i}`:`${e}${i}`}function ut(e,t="",s=""){return{get(i,r,a){let n=i[r];if(t===""&&r in i)return typeof n=="function"?n.bind(i):n;let o=i[s]||i;if(n=Reflect.get(o,r,a),L.isPlainObject(n)||Array.isArray(n)){let c=Fe(t,r);return new Proxy(n,ut(e,c,s))}return n},set(i,r,a,n){if(t===""&&r in i)return i[r]=a,!0;let o=Fe(t,r);return e.set(o,a),!0}}}var dt=(e,t="stage")=>new Proxy(e,ut(e,"",t)),We=class{static resume(e,t){if(!e)return null;let s,i=localStorage.getItem(e);return i===null?t&&(s=t):s=JSON.parse(i),s}static store(e,t){if(!e||!t)return!1;let s=JSON.stringify(t);return localStorage.setItem(e,s),!0}static remove(e){return e?(localStorage.removeItem(e),!0):!1}},pt=(e={})=>{let t={};if(!u.isObject(e))return t;let s=L.clone(e);return Object.keys(s).forEach(i=>{let r=s[i];typeof r!="function"&&(t[i]=r)}),t},os=0,V={CHANGE:"change",DELETE:"delete"},de=(e,t)=>`${e}:${t}`,he=class{constructor(e={}){this.dirty=!1,this.links={},this._init(),this.setup(),this.dataTypeId="bd",this.eventSub=new ht;let t=pt(e);return this.set(t),dt(this)}setup(){this.stage={}}_init(){let e=++os;this._dataNumber=e,this._id=`dt-${e}`,this._dataId=`${this._id}:`}getDataId(){return this._id}remove(){}on(e,t){let s=de(e,V.CHANGE);return this.eventSub.on(s,t)}off(e,t){let s=de(e,V.CHANGE);this.eventSub.off(s,t)}_setAttr(e,t,s=this,i=!1){let r=this.stage[e];t!==r&&(this.stage[e]=t,this._publish(e,t,s,V.CHANGE))}publishLocalEvent(e,t,s,i){let r=de(e,i);this.eventSub.publish(r,t,s)}_publish(e,t,s,i){this.publishLocalEvent(e,t,s,i),s=s||this,_.publish(this._dataId+e,t,s)}set(...e){if(typeof e[0]!="object")return this._setAttr(...e),this;let[t,s,i]=e;return Object.entries(t).forEach(([r,a])=>{typeof a!="function"&&this._setAttr(r,a,s,i)}),this}getModelData(){return this.stage}_deleteAttr(e,t,s=this){delete e[t],this.publishLocalEvent(t,null,s,V.DELETE)}toggle(e){if(!(typeof e>"u"))return this.set(e,!this.get(e)),this}increment(e){if(typeof e>"u")return;let t=this.get(e);return this.set(e,++t),this}decrement(e){if(typeof e>"u")return;let t=this.get(e);return this.set(e,--t),this}concat(e,t){if(typeof e>"u")return;let s=this.get(e);return this.set(e,s+t),this}ifNull(e,t){return this.get(e)===null&&this.set(e,t),this}setKey(e){return this.key=e,this}resume(e){let t=We.resume(this.key,e);return t?(this.set(t),this):this}store(){let e=this.get();return We.store(this.key,e)}delete(e){return typeof e=="string"?(this._deleteAttr(this.stage,e),this):(this.setup(),this)}_getAttr(e,t){return e[t]}get(e){return typeof e<"u"?this._getAttr(this.stage,e):this.getModelData()}link(e,t,s){if(arguments.length===1&&e.isData===!0&&(t=e.get()),typeof t!="object")return this.remoteLink(e,t,s);let i=[];return Object.entries(t).forEach(([r])=>{i.push(this.remoteLink(e,r))}),i}remoteLink(e,t,s){let i=s||t,r=e.get(t);typeof r<"u"&&this.get(t)!==r&&this.set(t,r);let a=e.on(t,(o,c)=>{if(c===this)return!1;this.set(i,o,e)});this.addLink(a,e);let n=this.on(i,(o,c)=>{if(c===e)return!1;e.set(t,o,this)});return e.addLink(n,this),a}addLink(e,t){this.links[e]=t}unlink(e){if(e){this.removeLink(e);return}let t=this.links;L.isEmpty(t)||(Object.entries(t).forEach(([s,i])=>{this.removeLink(i,!1)}),this.links={})}removeLink(e,t=!0){let s=this.links[e];s&&s.off(e),t!==!1&&delete this.links[e]}};he.prototype.isData=!0;var N={deepDataPattern:/(\w+)|(?:\[(\d)\))/g,hasDeepData(e){return e.indexOf(".")!==-1||e.indexOf("[")!==-1},getSegments(e){let t=this.deepDataPattern;return e.match(t)}},ne=class{static set(e,t,s){if(!N.hasDeepData(t)){e[t]=s;return}let i,r=N.getSegments(t),a=r.length,n=a-1;for(var o=0;o<a;o++){if(i=r[o],o===n){e[i]=s;break}e[i]===void 0&&(e[i]=isNaN(i)?{}:[]),e=e[i]}}static delete(e,t){if(!N.hasDeepData(t)){delete e[t];return}let s=N.getSegments(t),i=s.length,r=i-1;for(var a=0;a<i;a++){var n=s[a],o=e[n];if(o===void 0)break;if(a===r){if(Array.isArray(e)){e.splice(Number(n),1);break}delete e[n];break}e=o}}static get(e,t){if(!N.hasDeepData(t))return e[t]??void 0;let s=N.getSegments(t),i=s.length,r=i-1;for(var a=0;a<i;a++){var n=s[a],o=e[n]??void 0;if(o===void 0)break;if(e=o,a===r)return e}}},_e=class{static publishDeep(t,s,i,r){if(!N.hasDeepData(s)){this.publish(s,i,r);return}let a,n=N.getSegments(s),o=n.length,c=o-1,h="";for(var p=0;p<o;p++){a=n[p],t=t[a],p>0?isNaN(a)&&(h+="."+a):h=a;var m;if(p===c)m=i;else{var C=n[p+1];if(isNaN(C)===!1){h+="["+C+"]";continue}var E={};E[C]=t[C],m=E}this.publish(h,m,r)}}static publish(t,s,i){if(t=t||"",i(t,s),!(!s||typeof s!="object")){if(Array.isArray(s)){this.publishArray(t,s,i);return}this.publishObject(t,s,i)}}static publishArray(t,s,i){let r,a,n=s.length;for(var o=0;o<n;o++)a=s[o],r=t+"["+o+"]",this._checkPublish(r,a,i)}static publishObject(t,s,i){let r,a;for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(a=s[n],r=t+"."+n,this._checkPublish(r,a,i))}static _checkPublish(t,s,i){if(!s||typeof s!="object"){i(t,s);return}this.publish(t,s,i)}},ae=class extends he{setup(){this.attributes={},this.stage={}}_setAttr(e,t,s,i){typeof t!="object"&&t===this.get(e)||(!s&&i!==!0?ne.set(this.attributes,e,t):this.dirty===!1&&(this.dirty=!0),ne.set(this.stage,e,t),s=s||this,this._publish(e,t,s,V.CHANGE))}linkAttr(e,t){let s=e.get(t);if(s)for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&this.link(e,t+"."+i,i)}scope(e,t){let s=this.get(e);if(!s)return!1;t=t||this.constructor;let i=new t(s);return i.linkAttr(this,e),i}splice(e,t){return this.delete(e+"["+t+"]"),this.refresh(e),this}push(e,t){let s=this.get(e);return Array.isArray(s)===!1&&(s=[]),s.push(t),this.set(e,s),this}unshift(e,t){let s=this.get(e);return Array.isArray(s)===!1&&(s=[]),s.unshift(t),this.set(e,s),this}shift(e){let t=this.get(e);if(Array.isArray(t)===!1)return null;let s=t.shift();return this.set(e,t),s}getIndex(e,t,s){let i=this.get(e);return Array.isArray(i)===!1?-1:typeof i[0]!="object"?i.indexOf(t):i.findIndex(r=>r[t]===s)}pop(e){let t=this.get(e);if(Array.isArray(t)===!1)return null;let s=t.pop();return this.set(e,t),s}refresh(e){return this.set(e,this.get(e)),this}_publish(e,t,s,i){let r=(a,n)=>this._publishAttr(a,n,s,i);_e.publish(e,t,r)}_publishAttr(e,t,s,i){let r=this._dataId+e;_.publish(r,t,s),this.publishLocalEvent(e,t,s,i)}mergeStage(){this.attributes=L.clone(this.stage),this.dirty=!1}getModelData(){return this.mergeStage(),this.attributes}revert(){this.set(this.attributes),this.dirty=!1}_deleteAttr(e,t,s=this){ne.delete(e,t);let i=(r,a)=>this.publishLocalEvent(r,a,s,V.DELETE);_e.publish(t,t,i)}_getAttr(e,t){return ne.get(e,t)}},cs={"\n":"\\n","\r":"\\n","	":"\\t"},hs=(e,t)=>{typeof e!="string"&&(e=String(e));let s=t?/[\n\r\t]/g:/\t/g;return e.replace(s,i=>cs[i])},He=(e,t)=>{if(typeof e!="string")return e;e=hs(e,t),e=encodeURIComponent(e);let s=/%22/g;return e.replace(s,'"')},ft=(e,t)=>{let s=typeof e;return s==="undefined"?e:s!=="object"?(e=He(e),e):(Object.entries(e).forEach(([i,r])=>{r!==null&&(e[i]=typeof r=="string"?ft(r,t):He(r,t))}),e)};function us(e){return typeof e<"u"&&e.length>0?JSON.parse(e):!1}function Ue(e){return typeof e<"u"?JSON.stringify(e):null}var ye,ds=(ye=class{static prepareJsonUrl(e,t=!1){let s=typeof e=="object"?L.clone(e):e,i=ft(s,t);return Ue(i)}static xmlParse(e){return typeof e>"u"?!1:new DOMParser().parseFromString(e,"text/xml")}},d(ye,"json",{encode:Ue,decode:us}),ye),ps=class{constructor(e){this.model=e,this.objectType=this.objectType||"item",this.url="",this.validateCallBack=null,this.init()}init(){let e=this.model;e&&e.url&&(this.url=e.url)}isValid(){let e=this.validate();if(e!==!1){let t=this.validateCallBack;typeof t=="function"&&t(e)}return e}validate(){return!0}getDefaultParams(){return""}setupParams(e){let t=this.getDefaultParams();return e=this.addParams(e,t),e}objectToString(e){let t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.push(s+"="+e[s]);return t.join("&")}addParams(e,t){if(e=e||{},typeof e=="string"&&(e=z.parseQueryString(e,!1)),!t)return this._isFormData(e)?e:this.objectToString(e);if(typeof t=="string"&&(t=z.parseQueryString(t,!1)),this._isFormData(e))for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.append(s,t[s]);else e=Object.assign(e,t),e=this.objectToString(e);return e}get(e,t){let s=this.model.get("id"),i="id="+s,r=this.model;return this._get(`/${s}`,i,e,t,a=>{if(a){let n=this.getObject(a);n&&r.set(n)}})}getObject(e){return e[this.objectType]||e||!1}setupObjectData(){let e=this.model.get();return this.objectType+"="+ds.prepareJsonUrl(e)}setup(e,t){if(!this.isValid())return;let s=this.setupObjectData(),i=this.model.id,r=typeof i>"u"?"":`/${i}`;return this._put(r,s,e,t)}add(e,t){if(!this.isValid())return;let s=this.setupObjectData(),i=this.model.id,r=typeof i>"u"?"":`/${i}`;return this._post(r,s,e,t)}update(e,t){if(!this.isValid())return;let s=this.setupObjectData(),i=this.model.id,r=typeof i>"u"?"":`/${i}`;return this._patch(r,s,e,t)}delete(e,t){let s=this.model.get("id"),i=typeof s<"u"?"id="+s:this.setupObjectData(),r=typeof s>"u"?"":`/${s}`;return this._delete(r,i,e,t)}all(e,t,s,i,r=null,a=null){let n=this.model.get();s=isNaN(s)?0:s,i=isNaN(i)?50:i;let o=n.search||"",c=n.filter||"";typeof c=="object"&&(c=JSON.stringify(c));let h=n.dates||"";typeof h=="object"&&(h=JSON.stringify(h));let p=n.orderBy||"";typeof p=="object"&&(p=JSON.stringify(p));let m=n.groupBy||"";Array.isArray(m)&&(m=JSON.stringify(m));let C="&filter="+c+"&offset="+s+"&limit="+i+"&dates="+h+"&orderBy="+p+"&groupBy="+m+"&search="+o+"&lastCursor="+(typeof r<"u"&&r!==null?r:"")+"&since="+(typeof a<"u"&&a!==null?a:"");return this._get("",C,e,t)}getUrl(e){let t=this.url;if(!e)return this.replaceUrl(t);e[0]==="/"&&(e=e.substring(1));let s=e[0]==="?"?t+e:t+"/"+e;return this.replaceUrl(s)}setupRequest(e,t,s,i,r){let a={url:this.getUrl(e),method:t,params:s,completed:(n,o)=>{typeof r=="function"&&r(n),this.getResponse(n,i,o)}};return this._isFormData(s)&&(a.headers={}),Ze(a)}replaceUrl(e){return D.isWatching(e)&&(e=D.replaceParams(e,this.model)),e.endsWith("/")&&(e=e.substring(0,e.length-1)),e}_isFormData(e){return e instanceof FormData}request(e,t,s,i){return this._request("","POST",e,t,s,i)}_get(e,t,s,i,r){return t=this.setupParams(t),t=this.addParams(t,s),e=e||"",t&&(e+="?"+t),this.setupRequest(e,"GET","",i,r)}_post(e,t,s,i,r){return this._request(e,"POST",t,s,i,r)}_put(e,t,s,i,r){return this._request(e,"PUT",t,s,i,r)}_patch(e,t,s,i,r){return this._request(e,"PATCH",t,s,i,r)}_delete(e,t,s,i,r){return this._request(e,"DELETE",t,s,i,r)}_request(e,t,s,i,r,a){return s=this.setupParams(s),s=this.addParams(s,i),this.setupRequest(e,t,s,r,a)}getResponse(e,t,s){typeof t=="function"&&t(e,s)}static extend(e){if(!e)return!1;let t=this;class s extends t{constructor(r){super(r)}}return Object.assign(s.prototype,e),s}},fs=e=>{let t={};if(!u.isObject(e)||!e.defaults)return t;let{defaults:s}=e;return Object.keys(s).forEach(i=>{let r=s[i];typeof r!="function"&&(t[i]=r)}),delete e.defaults,t},ms=e=>{if(!e||typeof e.xhr!="object")return{};let t={...e.xhr};return delete e.xhr,t},gs=0,mt=class extends ae{constructor(e){let t=super(e);return this.initialize(),t}setup(){this.attributes={},this.stage={},this.url=this.url||"",this.xhr=this.xhr||{}}initialize(){}static extend(e={}){let t=this,s=ms(e),i=t.prototype.service.extend(s),r=fs(e);class a extends t{constructor(c){let h={...r,...pt(c)};super(h);d(this,"dataTypeId",`bm${gs++}`);this.xhr=new i(this)}}return Object.assign(a.prototype,e),a.prototype.service=i,a}};mt.prototype.service=ps;var gt=class extends he{},vs=class extends gt{constructor(e){super(),this.id=e}setup(){this.stage={},this.id=null}addAction(e,t){typeof t<"u"&&this.set(e,t)}getState(e){return this.get(e)}removeAction(e,t){if(t){this.off(e,t);return}let s=this.stage;typeof s[e]<"u"&&delete s[e]}},be,K=(be=class{static restore(e,t){this.targets.set(e,t)}static getTarget(e){return this.targets.has(e)||this.targets.set(e,new vs(e)),this.targets.get(e)}static getActionState(e,t){return this.getTarget(e).get(t)}static add(e,t,s){let i=this.getTarget(e);return t&&i.addAction(t,s),i}static addAction(e,t,s){return this.add(e,t,s)}static removeAction(e,t,s){this.off(e,t,s)}static on(e,t,s){let i=this.getTarget(e);return t?i.on(t,s):null}static off(e,t,s){this.remove(e,t,s)}static remove(e,t,s){let i=this.targets,r=i.get(e);if(r){if(t){r.off(t,s);return}this.targets.delete(e)}}static set(e,t,s){this.getTarget(e).set(t,s)}},d(be,"targets",new Map),be),ys=class{constructor(){this.events=[]}addEvents(t){t.length<1||t.forEach(s=>{this.on(...s)})}on(t,s,i,r){g.on(t,s,i,r),this.events.push({event:t,obj:s,callBack:i,capture:r})}off(t,s,i,r){g.off(t,s,i,r);let a,n=this.events;for(var o=0,c=n.length;o<c;o++)if(a=n[o],a.event===t&&a.obj===s){n.splice(o,1);break}}set(){this.events.forEach(t=>{g.on(t.event,t.obj,t.callBack,t.capture)})}unset(){this.events.forEach(t=>{g.off(t.event,t.obj,t.callBack,t.capture)})}reset(){this.unset(),this.events=[]}},bs=class{constructor(e,t){this.remoteStates=[];let s=this.convertStates(t);this.addStatesToTarget(e,s)}addStates(e,t){let s=this.convertStates(t);this.addStatesToTarget(e,s)}createState(e,t,s,i){return{action:e,state:t,callBack:s,targetId:i,token:null}}convertStates(e){let t=[];for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(s==="remotes"){this.setupRemoteStates(e[s],t);continue}var i=null,r=null,a=e[s];a&&typeof a=="object"&&(r=a.callBack,i=a.id||a.targetId,a=a.state),t.push(this.createState(s,a,r,i))}return t}setupRemoteStates(e,t){let s;for(var i=0,r=e.length;i<r;i++)if(s=e[i],!!s){for(var a in s)if(!(!Object.prototype.hasOwnProperty.call(s,a)||a==="id")){var n=null,o=s[a],c=o!==null?o:void 0;c&&typeof c=="object"&&(n=c.callBack,c=c.state),t.push(this.createState(a,c,n,s.id))}}}removeRemoteStates(e){let t=this.remoteStates;t&&this.removeActions(e,t)}removeActions(e,t){if(!(t.length<1))for(var s=0,i=t.length;s<i;s++){var r=t[s];r.token&&this.unbindRemoteState(e,r.token),K.remove(r.targetId,r.action,r.token)}}restore(e){K.restore(e.id,e);let t=this.remoteStates;if(t)for(var s=0,i=t.length;s<i;s++){var r=t[s];r.token=this.bindRemoteState(e,r.action,r.targetId)}}bindRemoteState(e,t,s){let i=K.getTarget(s);return e.link(i,t)}unbindRemoteState(e,t){e.unlink(t)}addStatesToTarget(e,t){let s=this.remoteStates;for(var i=0,r=t.length;i<r;i++){var a=t[i],n=this.addAction(e,a);a.targetId&&(a.token=n,s.push(a))}s.length<1&&(this.remoteStates=[])}addAction(e,t){let s,i=t.action,r=t.targetId;r&&(s=this.bindRemoteState(e,i,r)),typeof t.state<"u"&&e.addAction(i,t.state);let a=t.callBack;return typeof a=="function"&&e.on(i,a),s}},ws=e=>{if(!e)return tt();let t=e[0];return typeof t=="string"?st(t):Array.isArray(t)?it(t):rt(e)};P.addType("components",e=>{if(!e)return;let t=e.component;!t||!t.isUnit||(t.rendered===!0&&t.prepareDestroy(),t.persistToken&&t.parent&&t.parent.removePersistedChild(t.persistToken))});var Ss=0,Ps=class{constructor(...e){this.isUnit=!0,this.data=null,this.persist=null,this.nest=null,this.state=null,this.panel=null,this.parent=null,this.unitType=null,this.init();let{props:t,children:s}=ws(e);this.setupProps(t),this.children=s||[],this.persistedChildren={},this.persistedCount=0,this.onCreated(),this.rendered=!1,this.container=null}init(){this.id="cp-"+Ss++,this.unitType=this.constructor.name.toLowerCase()}declareProps(){}addPersistedChild(e){let t=this.persistedCount++,s="pc"+t,i=Object.keys(this.persistedChildren)[t],r=this.persistedChildren[i];return r&&e.unitType===r.unitType&&(s=i,e.resumeScope(r)),e.persistToken=s,this.persistedChildren[s]=e,s}removePersistedChild(e){this.rendered&&(!e||!this.persistedChildren[e]||delete this.persistedChildren[e])}setupProps(e){if(this.declareProps(),!(!e||typeof e!="object"))for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this[t]=e[t])}getChildScope(){return this}getParentContext(){return this.parent?this.parent.getContext():null}setupContext(){let e=this.getParentContext(),t=this.setContext(e);if(t){this.context=t;return}this.context=e,this.setupAddingContext()}setupAddingContext(){let e=this.context,t=this.addContext(e);if(!t)return;let s=t[0];s&&(this.addingContext=!0,this.contextBranchName=s,this.addContextBranch(s,t[1]))}addContextBranch(e,t){this.context??(this.context={}),this.context[e]=t}setContext(e){return null}addContext(e){return null}removeContext(){this.addingContext&&this.removeContextBranch(this.contextBranchName)}removeContextBranch(e){e&&delete this.context[e]}getContext(){return this.context}onCreated(){}render(){return{}}_cacheRoot(e){return e&&(e.id||(e.id=this.getId()),e.cache="panel",e)}_createLayout(){return this.render()}prepareLayout(){let e=this._createLayout();return this._cacheRoot(e)}afterBuild(){P.add(this.panel,"components",{component:this}),this.rendered=!0,this.afterLayout()}afterLayout(){this.afterSetup()}if(e,t){return e?t||e:null}map(e,t){let s=[];if(!e||e.length<1)return s;for(var i=0,r=e.length;i<r;i++){let a=t(e[i],i);s.push(a)}return s}removeAll(e){return ie.removeAll(e)}getId(e){let t=this.id;return typeof e=="string"&&(t+="-"+e),t}initialize(){this.setupContext(),this.beforeSetup()}beforeSetup(){}afterSetup(){}setup(e){this.setContainer(e),this.initialize()}setContainer(e){this.container=e}_remove(){this.prepareDestroy(),this.removeContext();let e=this.panel||this.id;ie.removeElement(e)}prepareDestroy(){this.persistedCount=0,this.rendered=!1,this.beforeDestroy()}beforeDestroy(){}destroy(){this._remove()}},A=class extends Ps{constructor(...e){super(...e),this.isComponent=!0,this.stateResumed=!1,this.stateTargetId=null,this._setupData()}setData(){return null}_setupData(){if(this.data)return;let e=this.setData();e&&(this.data=e)}resumeScope(e){this.data=e.data,this.state=e.state,this.stateHelper=e.stateHelper,this.persistedChildren=e.persistedChildren,this.id=e.id}initialize(){this.setupContext(),this.addStates(),this.beforeSetup()}afterLayout(){this.addEvents(),this.afterSetup()}setupStateTarget(e){let t=e||this.stateTargetId||this.id;this.state=K.getTarget(t)}setupStates(){return{}}addStates(){let e=this.state;if(e){this.stateResumed=!0,this.stateHelper.restore(e);return}let t=this.setupStates();L.isEmpty(t)||this.setStateHelper(t)}setStateHelper(e={}){this.state||(this.setupStateTarget(),this.stateHelper=new bs(this.state,e))}addState(e){!this.stateHelper||this.stateResumed==!0||this.stateHelper.addStates(this.state,e)}removeStates(){let e=this.state;e&&(this.stateHelper.removeRemoteStates(e),e.remove(),this.stateResumed=!1)}setEventHelper(){this.events||(this.events=new ys)}setupEvents(){return[]}addEvents(){let e=this.setupEvents();e.length<1||(this.setEventHelper(),this.events.addEvents(e))}removeEvents(){let e=this.events;e&&e.reset()}prepareDestroy(){this.persistedCount=0,this.rendered=!1,this.beforeDestroy(),this.removeEvents(),this.removeStates(),this.removeContext(),this.data&&this.persist===!1&&this.data.unlink()}},ks={created:"onCreated",setStates:"setupStates",state:"setupStates",events:"setupEvents",before:"beforeSetup",render:"render",after:"afterSetup",destroy:"beforeDestroy"},xs=e=>typeof e=="function"?e:()=>e,Cs=e=>{let t={};return e&&Object.entries(e).forEach(([s,i])=>{let r=ks[s]||s;t[r]=xs(i)}),t},$e=(e,t)=>{class s extends e{}return Object.assign(s.prototype,t),s},Be=(e,t=A)=>{if(!e)return null;let s,i=typeof e;return i==="object"&&e.render?(s=Cs(e),$e(t,s)):(s={render:i==="function"?e:()=>e},$e(t,s))},Ls=(e,t)=>({name:e,callBack:t}),Ce={keys:[],items:{},add(e,t){return this.keys.push(e),this.items[e]=Ls(e,t),this},get(e){return this.items[e]||null},all(){return this.keys}},Xe=(e,t)=>({attr:e,directive:t}),se=(e,t)=>({key:e,value:t}),As=(e,t,s,i)=>({tag:e,attr:t,directives:s,children:i}),De=class{static getTag(e){return e.tag||"div"}static setupChildren(e){e.nest&&(e.children=e.nest,delete e.nest)}static setElementContent(e,t,s,i){return e==="text"?(i.push({tag:"text",textContent:t}),!0):e==="html"||e==="innerHTML"?(s.push(se("innerHTML",t)),!0):!1}static setTextAsWatcher(e,t,s){e.push(Xe(se(t,D.getWatcherSettings(s,Ee(t))),Ce.get("watch")))}static setButtonType(e,t,s){if(e==="button"){let i=t.type||"button";s.push(se("type",i))}}static parse(e,t){let s=[],i=[],r=this.getTag(e);this.setButtonType(r,e,s),this.setupChildren(e);let a=[];var n,o;for(var c in e){if(!L.hasOwnProp(e,c)||c==="tag"||(n=e[c],n==null))continue;if((o=Ce.get(c))!==null){i.push(Xe(se(c,n),o));continue}let h=typeof n;if(h==="object"){if(c==="children"){a=a.concat(n);continue}if(D.isWatching(n)){this.setTextAsWatcher(i,c,n);continue}a.push(n);continue}if(h==="function"){let p=n;n=function(m){p.call(this,m,t)}}if(D.isWatching(n)){this.setTextAsWatcher(i,c,n);continue}this.setElementContent(c,n,s,a)||s.push(se(c,n))}return As(r,s,i,a)}},vt=class{build(e,t,s){}setupComponent(e,t,s){e.parent=s,s&&s.persist===!0&&e.persist!==!1&&(e.persist=!0,e.parent.addPersistedChild(e)),e.cache&&s&&(s[e.cache]=e),e.setup(t)}buildComponent(e){let t=e.prepareLayout(),s=this.build(t,e.container,e.getChildScope());return e.afterBuild(),e.component&&typeof e.onCreated=="function"&&e.onCreated(e),s}createComponent(e,t,s){return this.setupComponent(e,t,s),this.buildComponent(e),e}setDirectives(e,t,s){}removeNode(e){}removeAll(e){}},Ts=class extends vt{build(t,s,i){let r=I.createDocFragment();return(Array.isArray(t)?t:[t]).forEach(a=>this.buildElement(a,r,i)),s&&typeof s=="object"&&s.appendChild(r),r}buildElement(t,s,i){if(t){if(t.isUnit===!0){this.createComponent(t,s,i);return}this.createElement(t,s,i)}}createElement(t,s,i){let r=De.parse(t,i),a=this.createNode(r,s,i);this.cache(a,t.cache,i),r.children.forEach(o=>{o!==null&&this.buildElement(o,a,i)});let n=r.directives;n&&n.length&&this.setDirectives(a,n,i)}setDirectives(t,s,i){s.forEach(r=>{this.handleDirective(t,r,i)})}handleDirective(t,s,i){s.directive.callBack(t,s.attr.value,i)}cache(t,s,i){i&&s&&(i[s]=t)}createNode(t,s,i){let r=t.tag;if(r==="text"){let a=t.attr[0],n=a?a.value:"";return I.createText(n,s)}else if(r==="comment"){let a=t.attr[0],n=a?a.value:"";return I.createComment(n,s)}return I.create(r,t.attr,s,i)}removeNode(t){I.removeElement(t)}removeAll(t){I.removeAll(t)}},Es=["area","base","br","col","embed","hr","img","input","link","meta","source"],pe=class{static create(e,t=[],s=""){let i=this.getInnerContent(t);i+=this.getInnerHtml(t);let r=this.createAttributes(t);return Es.includes(e)?`<${e} ${r} />`:`<${e} ${r}>`+i+s+`</${e}>`}static getInnerContent(e){let t="";return e.forEach(({key:s,value:i},r)=>{if(s!=="text"&&s!=="textContent")return"";e.splice(r,1),t+=i}),t}static getInnerHtml(e){let t="";return e.forEach(({key:s,value:i},r)=>{if(s!=="html"&&s!=="innerHTML")return"";e.splice(r,1),t+=i}),t}static createAttributes(e=[]){return!e||e.length<1?"":e.map(t=>{let{key:s,value:i}=t;return typeof i=="function"&&(s="on"+Oe(s)),`${s}="${i}"`}).join(" ")}static createText(e){return e}static createComment(e){return`<!-- ${e} -->`}},Os=class extends vt{build(e,t,s){return(Array.isArray(e)?e:[e]).map(i=>this.buildElement(i,s)).join("")}createComponent(e,t,s){return this.setupComponent(e,t,s),this.buildComponent(e)}buildElement(e,t){return e?e.isUnit===!0?this.createComponent(e,t):this.createElement(e,t):""}createElement(e,t){let s=De.parse(e,t),i=s.children.map(r=>r!==null?this.buildElement(r,t):"").join("");return this.createNode(s,i)}createNode(e,t){let s=e.tag;if(s==="text"){let i=e.attr[0],r=i?i.value:"";return pe.createText(r)}else if(s==="comment"){let i=e.attr[0],r=i?i.value:"";return pe.createComment(r)}return pe.create(s,e.attr,t)}removeAll(e){}},Bs=class{static browserIsSupported(){return typeof window<"u"&&typeof document=="object"}static setup(){return this.browserIsSupported()?new Ts:new Os}},H=Bs.setup(),Ds=e=>typeof e=="object"&&e.isUnit===!0,js=e=>{let t=Be(e);return new t},k=class{static render(e,t,s){return e?(Ds(e)||(e=js(e)),H.createComponent(e,t,s)):null}static build(e,t,s){return H.build(e,t,s)}static rebuild(e,t,s){return H.removeAll(t),this.build(e,t,s)}static setDirectives(e,t,s){H.setDirectives(e,t,s)}static createNode(e,t,s){return H.createNode(e,t,s)}static removeNode(e){H.removeNode(e)}static removeAll(e){H.removeAll(e)}};Z.augment({buildLayout(e,t,s){k.build(e,t,s)}});var je=[],Is=e=>je.indexOf(e)!==-1,Ns=e=>({tag:"script",src:e.src,async:!1,load(t){je.push(e.src);let s=e.load;s&&s()}}),Rs=e=>({tag:"link",rel:"stylesheet",type:"text/css",href:e.src,load(t){je.push(e.src);let s=e.load;s&&s()}}),zs=class{constructor(t){this.percent=0,this.loaded=0,this.total=0,this.callBack=t||null}add(t){this.total++;let s,i=this.update.bind(this);t.indexOf(".css")!==-1?s=Rs({load:i,src:t}):s=Ns({load:i,src:t}),k.build(s,document.head)}addFiles(t){t&&t.forEach(s=>{Is(s)||this.add(s)})}update(){if(this.updateProgress()<100)return;let t=this.callBack;t&&t()}updateProgress(){return++this.loaded,this.percent=Math.floor(this.loaded/this.total*100)}},Ms=e=>{var t;return e?typeof((t=e==null?void 0:e.prototype)==null?void 0:t.constructor)=="function":!1},fe=class{static process(e,t){let s=e.default;return s?t.callback?t.callback(s):(Ms(s)?s=new s:s=s(),s.isUnit===!0&&(s.route=t.route,t.persist&&(s.persist=!0)),s):null}static render(e,t,s){let i=k.build(e,null,s),r=i.firstChild||(e==null?void 0:e.panel);return t.after(i),r}},Fs=class{static load(e,t){return e.then(s=>(t&&t(s),s))}},Ws=e=>({tag:"comment",textContent:"import placeholder",onCreated:e.onCreated}),_s=e=>{let t=typeof e;return t==="string"?import(e):t==="function"?e():e},Hs=Be({declareProps(){this.loaded=!1,this.blockRender=!1},render(){return Ws({onCreated:e=>{if(this.src){if(this.layout){this.layoutRoot=fe.render(this.layout,this.panel,this.parent);return}if(this.depends){new zs(()=>{this.loadAndRender(e)}).addFiles(this.depends);return}this.loadAndRender(e)}}})},loadAndRender(e){this.src=_s(this.src),Fs.load(this.src,t=>{if(this.loaded=!0,this.blockRender===!0){this.blockRender=!1;return}let s=this.layout||fe.process(t,{callback:this.callback,route:this.route,persist:this.persist});this.layout=s,this.layoutRoot=fe.render(s,e,this.parent)})},shouldUpdate(e){return this.updateLayout===!0?!0:this.updateLayout=e&&e.isUnit&&typeof e.update=="function"},updateModuleLayout(e){let t=this.layout;this.shouldUpdate(t)&&t.update(e)},update(e){this.loaded===!0&&this.updateModuleLayout(e)},destroy(){if(!this.layoutRoot){this.blockRender=!0;return}this.blockRender=!1,k.removeNode(this.layoutRoot)}}),Us=e=>{let t=typeof e;return(t==="string"||t==="function"||e instanceof Promise)&&(e={src:e}),new Hs(e)},yt=(e,t,s=null)=>{g.on("animationend",e,function i(){x.removeClass(e,t),g.off("animationend",e,i),s&&s()}),x.addClass(e,t)},$s=(e,t,s)=>{yt(e,t)},Xs=(e,t,s)=>{let i=()=>{e&&e.parentNode&&e.isConnected&&e.parentNode.removeChild(e)};Ys(e,()=>yt(e,t,i),s)};P.addType("manual-destroy",e=>{if(!e)return!1;e.callBack(e.ele,e.parent)});var Ys=(e,t,s)=>{P.add(e,"manual-destroy",{ele:e,callBack:t,parent:s})},Ie=(e,t,s,i)=>{if(Array.isArray(s[0])){s.forEach(r=>{r&&Ie(e,t,r,i)});return}Gs(e,t,s,i)},Gs=(e,t,s,i)=>{let r,a;if(s.length<3?[r,a]=s:[t,r,a]=s,!t||!r)return;let n=qs(e,r,a,i);_.watch(e,t,r,n)},qs=(e,t,s,i)=>typeof s=="object"?r=>{Ks(e,s,r)}:r=>{Vs(e,s,t,r,i)},Vs=(e,t,s,i,r)=>{let a=t(i,e,r);switch(typeof a){case"object":Js(a,e,r);break;case"string":let n=ot(e);if(n!=="textContent"){x.setAttr(e,n,a);break}ie.addHtml(e,a);break}},Js=(e,t,s)=>{k.rebuild(e,t,s)},Ks=(e,t,s)=>{for(let[i,r]of Object.entries(t))i&&(r===s?x.addClass(e,i):x.removeClass(e,i))},Ne=(e,t,s)=>{let i=ee(s);Ie(e,i,t,s)},Qs=(e,t,s)=>{t&&t&&x.setAttr(e,"role",t)},Zs=e=>(t,s)=>{let i=t?"true":"false";x.setAttr(s,e,i)},ei=(e,t,s)=>{if(!t)return;let i=t.role;i&&(x.setAttr(e,"role",i),t.role=null),Object.entries(t).forEach(([r,a])=>{if(a===null)return;let n=`aria-${r}`;if(Array.isArray(a)){let o=[...a];o.push(Zs(n)),Ne(e,o,s)}else x.setAttr(e,n,a)})},ti=(e,t,s)=>{if(!t)return;let i=De.parse(t,s);I.addAttributes(e,i.attr,s),k.setDirectives(e,i.directives,s)};P.addType("context",e=>{if(!e)return!1;e.parent.removeContextBranch(e.branch)});var Re=e=>e?e.getContext():null,si=(e,t,s)=>{if(typeof t!="function")return;let i=Re(s),r=t(i);ti(e,r,s)},ii=(e,t,s)=>{if(typeof t!="function")return;let i=Re(s);t(i)},ri=(e,t,s)=>{if(typeof t!="function"||!s)return;let i=Re(s),r=t(i);r&&s.addContextBranch(r[0],r[1])},ai=(e,t,s)=>{if(!s)return;let i=s._layout?s._layout:s.render();console.log("Debug: ","ele: ",e),console.log("Data: ",t),console.log("Layout: ",i),console.log("parent: ",s)},ni=(e,t,s)=>{},li=(e,t,s)=>{if(!t||!s)return;let i=t(s,e);i&&k.build(i,e,s)},oi=(e,t,s)=>{if(!t||!s)return;let i=s.getId(t);e.id=i},ci=(e,t,s)=>{if(!t||!s)return;let i=t(s.data,e);i&&k.build(i,e,s)},hi=(e,t,s)=>{if(!t||!s)return;let i=t(s.state,e);i&&k.build(i,e,s)},ui=(e,t,s)=>{if(!t||!s)return;let i=s.state,r=t(i);if(!s.state){s.setStateHelper(r);return}s.addState(r)},di=(e,t,s)=>{if(!(!t||!s)){if(s.events||s.setEventHelper(),t[2]){let i=t[2];t[2]=r=>{i(r,s)}}s.events.on(...t)}},pi=(e,t,s)=>{let i,r,a;if(typeof t=="string"){if(i=ee(s),!i)return;r=t}else if(Array.isArray(t)){if(typeof t[0]!="object"){let n=ee(s);if(!n)return;t.unshift(n)}[i,r,a]=t}_.bind(e,i,r,a)},bt=(e,t,s)=>{Ie(e,s.state,t,s)},wt=e=>(t,s)=>{let[i,r,a="active"]=e,n=t===r?a:"";x.setData(s,i,n)},fi=(e,t,s)=>{if(!t)return;let i=[...t],r=i.pop();i.push(wt(r)),Ne(e,i,s)},mi=(e,t,s)=>{if(!t)return;let i=[...t],r=i.pop();i.push(wt(r)),bt(e,i,s)},gi=(e,t,s)=>{let i,r,a,n;if(t.length<3){let c=ee(s);if(!c)return;i=c,[r,a,n]=t}else[i,r,a,n]=t;let o=n!==!1;_.watch(e,i,r,c=>{if(k.removeAll(e),!c||c.length<1)return;let h=[];return c.forEach((p,m)=>{let C=o?i.scope(`${r}[${m}]`):null,E=a(c[m],m,C,h);E!==null&&h.push(E)}),k.build(h,e,s)})},vi=(e,t,s)=>{let i=t[0];if(!i||i.length<1)return;let r=t[1],a=[];i.forEach((n,o)=>{if(!n)return;let c=r(n,o);c!==null&&a.push(c)}),k.build(a,e,s)},yi=(e,t,s)=>{t(e,s)};P.addType("destroyed",e=>{if(!e)return!1;e.callBack(e.ele,e.parent)});var bi=(e,t,s)=>{wi(e,t,s)},wi=(e,t,s)=>{P.add(e,"destroyed",{ele:e,callBack:t,parent:s})},Si=(e,t,s)=>{if(t)if(Array.isArray(t)&&typeof t[0]!="string")for(var i=0,r=t.length;i<r;i++)D.setup(e,t[i],s);else D.setup(e,t,s)},Pi=0,St=class{constructor(e){this.router=e,this.locationId="base-app-router-"+Pi++,this.callBack=this.check.bind(this)}setup(){return this.addEvent(),this}check(e){}getScrollPosition(){return{x:window.scrollX,y:window.scrollY}}scrollTo(e){window.scrollTo(e.x,e.y)}addEvent(){return this}},ki=class extends St{addEvent(){return g.on("popstate",window,this.callBack),this}removeEvent(){return g.off("popstate",window,this.callBack),this}check(t){let s=t.state;if(!s||s.location!==this.locationId)return!1;t.preventDefault(),t.stopPropagation(),this.router.checkActiveRoutes(s.uri);let i=s.scrollPosition;i&&this.scrollTo(i)}createState(t,s={}){let i=this.getScrollPosition();return{location:this.locationId,...s,scrollPosition:i,uri:t}}addState(t,s,i=!1){let r=window.history,a=r.state;if(a&&a.uri===t)return this;let n=this.createState(t,s);return r[i===!1?"pushState":"replaceState"](n,null,t),this}},xi=class extends St{addEvent(){return g.on("hashchange",window,this.callBack),this}removeEvent(){return g.off("hashchange",window,this.callBack),this}check(e){this.router.checkActiveRoutes(e.newURL)}addState(e,t,s){return window.location.hash=e,this}},Ci=class{static browserIsSupported(){return typeof window=="object"&&"history"in window&&"pushState"in window.history}static setup(t){return this.browserIsSupported()?new ki(t).setup():new xi(t).setup()}},Li=class extends A{getChildScope(){return this.parent}},Ai=e=>Be(e,Li),Ti=class{constructor(e,t){this.route=e,this.template=t.component,this.component=null,this.hasTemplate=!1,this.setup=!1,this.container=t.container,this.persist=t.persist,this.parent=t.parent}focus(e){this.setup===!1&&this.create(),this.update(e)}setupTemplate(){let e=typeof this.template;e==="function"?this.initializeComponent():e==="object"&&this.initializeTemplateObject(),this.hasTemplate=!0}initializeComponent(){let e=this.template();this.transferSettings(e)}transferSettings(e){this.persist=this.persist&&e.persist!==!1,Object.assign(e,{route:this.route,persist:this.persist}),this.component=e}initializeTemplateObject(){this.template.isUnit||(this.template=new(Ai(this.template)));let e=this.template;this.transferSettings(e)}create(){if(this.setupTemplate(),!this.hasTemplate)return;this.setup=!0;let e=this.component;k.render(e,this.container,this.parent)}remove(){if(this.setup!==!0)return;this.setup=!1;let e=this.component;e&&(typeof e.destroy=="function"&&e.destroy(),this.component=null)}update(e){let t=this.component;t&&typeof t.update=="function"&&t.update(e)}},Ei=e=>{if(!e.length)return null;let t={};return e.forEach(s=>{t[s]=null}),t},Oi=e=>{let t=[];if(!e)return t;let s=/[*?]/g;e=e.replace(s,"");let i=/:(.[^./?&($]+)\?*/g,r=e.match(i);return r===null||r.forEach(a=>{a&&(a=a.replace(":",""),t.push(a))}),t},Bi=e=>e.replace(/\//g,"/"),Di=e=>e.replace(/(\/):[^/(]*?\?/g,t=>t.replace(/\//g,"(?:$|/)")),ji=e=>(e=e.replace(/(\?\/+\*?)/g,"?/*"),e.replace(/(:[^/?&($]+)/g,t=>t.indexOf(".")<0?"([^/|?]+)":"([^/|?]+.*)")),Ii=e=>e.replace(/(\*)/g,".*"),Ni=(e,t)=>e+=t[t.length-1]==="*"?"":"$",Ri=e=>{if(!e)return"";let t=Bi(e);return t=Di(t),t=ji(t),t=Ii(t),t=Ni(t,e),t},zi=0,Mi=class extends he{constructor(e,t){let s=e.baseUri,i=Oi(s),r=Ei(i),a=super(r);return this.uri=s,this.paramKeys=i,this.titleCallBack=t,this.setupRoute(e),this.set("active",!1),a}setup(){this.stage={},this.id=null,this.uri=null,this.uriQuery=null,this.controller=null,this.paramKeys=null,this.titleCallBack=null,this.path=null,this.referralPath=null,this.params=null,this.callBack=null,this.title=null,this.preventScroll=!1}setupRoute(e){this.id=e.id||"bs-rte-"+zi++,this.path=null,this.referralPath=null;let t=Ri(this.uri);this.uriQuery=new RegExp("^"+t),this.params=null,this.setupComponentHelper(e),this.callBack=e.callBack,this.title=e.title,this.preventScroll=e.preventScroll||!1}setTitle(e){this.titleCallBack(this,e)}deactivate(){this.set("active",!1);let e=this.controller;e&&e.remove()}getLayout(e){if(e.component)return e.component;let t=e.import;return t?Us(t):null}setupComponentHelper(e){let t=this.getLayout(e);if(!t)return;let{container:s,persist:i,parent:r}=e,a={component:t,container:s,persist:i,parent:r},n=dt(this);this.controller=new Ti(n,a)}resume(e){let t=this.controller;t&&(t.container=e)}setPath(e,t){this.path=e,this.referralPath=t}select(){this.set("active",!0);let e=this.stage,t=this.callBack;typeof t=="function"&&t(e);let s=this.controller;s&&s.focus(e);let i=this.path;if(!i)return;let r=i.split("#")[1];r&&this.scrollToId(r)}scrollToId(e){if(!e)return;let t=document.getElementById(e);t&&t.scrollIntoView(!0)}match(e){let t=!1,s=e.match(this.uriQuery);return s===null?(this.resetParams(),t):(Array.isArray(s)&&(s.shift(),t=s,this.setParams(s)),t)}resetParams(){this.stage={}}setParams(e){if(!Array.isArray(e))return;let t=this.paramKeys;if(!t)return;let s={};t.forEach((i,r)=>{typeof i<"u"&&(s[i]=e[r])}),this.set(s)}getParams(){return this.stage}},Fi=e=>{let t=/\w\S*/;return e.replace(t,s=>s.charAt(0).toUpperCase()+s.substring(1).toLowerCase())},Wi=(e,t)=>{if(e.indexOf(":")===-1)return e;let s=t.stage;for(let[i,r]of Object.entries(s)){let a=new RegExp(":"+i,"gi");e=e.replace(a,r)}return e},_i=(e,t)=>t&&(typeof t=="function"&&(t=t(e.stage)),t=Wi(t,e),Fi(t)),Hi=(e,t)=>(t!==""&&(e+=" - "+t),e),Ui=(e,t,s)=>t&&(t=_i(e,t),Hi(t,s)),$i={removeSlashes(e){return typeof e!="string"?"":(e.substring(0,1)==="/"&&(e=e.substring(1)),e.substring(-1)==="/"&&(e=e.substring(0,e.length-1)),e)}},Xi=()=>typeof window<"u"?window.location:{},Yi=class{constructor(){this.version="1.0.2",this.baseURI="/",this.title="",this.lastPath=null,this.path=null,this.history=null,this.callBackLink=null,this.location=Xi(),this.routes=[],this.switches=new Map,this.switchCount=0,this.data=new ae({path:""})}setupHistory(){this.history=Ci.setup(this)}createRoute(e){let t=e.uri||"*";return e.baseUri=this.createURI(t),new Mi(e,this.updateTitle.bind(this))}add(e){if(typeof e!="object"){let s=arguments;e={uri:s[0],component:s[1],callBack:s[2],title:s[3],id:s[4],container:s[5]}}let t=this.createRoute(e);return this.addRoute(t),t}addRoute(e){this.routes.push(e),this.checkRoute(e,this.getPath())}resume(e,t){e.resume(t),this.addRoute(e)}getBasePath(){if(!this.basePath){let e=this.baseURI||"";e[e.length-1]!=="/"&&(e+="/"),this.basePath=e}return this.basePath}createURI(e){return this.getBasePath()+$i.removeSlashes(e)}getRoute(e){let t=this.routes,s=t.length;if(s>0)for(var i=0;i<s;i++){var r=t[i];if(r.uri===e)return r}return!1}getRouteById(e){let t=this.routes,s=t.length;if(s>0)for(var i=0;i<s;i++){var r=t[i];if(r.id===e)return r}return!1}removeRoute(e){let t=this.routes,s=t.indexOf(e);s>-1&&t.splice(s,1)}addSwitch(e){let t=this.switchCount++,s=this.getSwitchGroup(t);return e.forEach(i=>{let r=this.createRoute(i);s.push(r)}),this.checkGroup(s,this.getPath()),t}resumeSwitch(e,t){let s=this.switchCount++,i=this.getSwitchGroup(s);return e.forEach(r=>{let a=r.component.route;a.resume(t),i.push(a)}),this.checkGroup(i,this.getPath()),s}getSwitchGroup(e){let t=this.switches.get(e);if(t)return t;let s=[];return this.switches.set(e,s),s}removeSwitch(e){this.switches.delete(e)}remove(e){e=this.createURI(e);let t=this.getRoute(e);return t!==!1&&this.removeRoute(t),this}setup(e,t){this.baseURI=e||"/",this.updateBaseTag(this.baseURI),this.title=typeof t<"u"?t:"",this.setupHistory(),this.data.path=this.getPath(),this.callBackLink=this.checkLink.bind(this),g.on("click",document,this.callBackLink);let s=this.getEndPoint();return this.navigate(s,null,!0),this}updateBaseTag(e){let t=document.getElementsByTagName("base");t.length&&(t[0].href=e)}getParentLink(e){let t=e.parentNode;for(;t!==null;){if(t.nodeName.toLowerCase()==="a")return t;t=t.parentNode}return!1}checkLink(e){if(e.ctrlKey===!0)return!0;let t=e.target||e.srcElement;if(t.nodeName.toLowerCase()!=="a"&&(t=this.getParentLink(t),t===!1)||t.target==="_blank"||x.data(t,"cancel-route"))return!0;let s=t.getAttribute("href");if(typeof s<"u"){let i=this.baseURI,r=i!=="/"?s.replace(i,""):s;return this.navigate(r),e.preventDefault(),e.stopPropagation(),!1}}reset(){return this.routes=[],this.switches=new Map,this.switchCount=0,this}activate(){return this.checkActiveRoutes(),this}navigate(e,t,s){return e=this.createURI(e),this.history.addState(e,t,s),this.activate(),this}updatePath(){let e=this.getPath();this.data.path=e}updateTitle(e){if(!e||!e.title)return this;let t=e.title;document.title=Ui(e,t,this.title)}checkActiveRoutes(e){this.lastPath=this.path,e=e||this.getPath(),this.path=e;let t=this.routes,s=t.length,i;for(var r=0;r<s;r++)i=t[r],!(typeof i>"u")&&this.checkRoute(i,e);this.checkSwitches(e),this.updatePath()}checkSwitches(e){this.switches.forEach(t=>{this.checkGroup(t,e)})}checkGroup(e,t){if(!e.length)return;let s=e.find(a=>a.get("active"));s&&s.match(t)===!1&&s.deactivate();let i;for(let a of e)if(!(typeof a>"u")){if(i){a.deactivate();continue}a.match(t)!==!1&&i===void 0&&a.controller&&(i=a,this.select(a))}let r=e[0];i||this.select(r)}checkRoute(e,t){let s=this.check(e,t);return s!==!1?this.select(e):e.deactivate(),s}check(e,t){return e?(t=t||this.getPath(),e.match(t)!==!1):!1}select(e){e&&(e.setPath(this.path,this.lastPath),e.select(),this.updateTitle(e),e.preventScroll!==!0&&this.checkToScroll())}checkToScroll(){this.shouldScrollToTop()&&window.scrollTo(0,0)}cleanPath(e){return e?e.split("?")[0].split("#")[0]:"/"}shouldScrollToTop(){let e=this.cleanPath(this.getPath()),t=this.cleanPath(this.lastPath).split("/"),s=e.split("/");if(t.length!==s.length)return!0;let i=t[t.length-1],r=s[s.length-1];return i!==r}getEndPoint(){return this.getPath().replace(this.baseURI,"")||"/"}destroy(){g.off("click",document,this.callBackLink)}getPath(){let e=this.location,t=this.path=e.pathname;return this.history.type==="hash"?e.hash.replace("#",""):t+e.search+e.hash}},M=new Yi;P.addType("routes",e=>{if(!e)return!1;let t=e.route;t&&M.removeRoute(t)});var Gi=(e,t,s)=>{t&&(Array.isArray(t)?t.forEach(i=>{Ye(e,i,s)}):Ye(e,t,s))},Ye=(e,t,s)=>{t.container=e,t.parent=s;let i=M.add(t);qi(e,i)},qi=(e,t)=>{P.add(e,"routes",{route:t})};P.addType("switch",e=>{if(!e)return!1;let t=e.id;M.removeSwitch(t)});var Vi=(e,t,s)=>{t[0],t.forEach(r=>{r.container=e,r.parent=s});let i=M.addSwitch(t);Ji(e,i)},Ji=(e,t)=>{P.add(e,"switch",{id:t})};Ce.add("cache",ni).add("onCreated",yi).add("onDestroyed",bi).add("bind",pi).add("onSet",Ne).add("onState",bt).add("animateIn",$s).add("animateOut",Xs).add("watch",Si).add("useParent",li).add("useData",ci).add("useState",hi).add("getId",oi).add("addState",ui).add("addEvent",di).add("map",vi).add("for",gi).add("useContext",ii).add("addContext",ri).add("context",si).add("role",Qs).add("aria",ei).add("route",Gi).add("debug",ai).add("dataSet",fi).add("dataStateSet",mi).add("switch",Vi);Z.augment({Ajax:Ze,Html:ie,dataBinder:_,Data:ae,SimpleData:gt,Model:mt,State:K,Builder:k,router:M,Component:A});var w=(e,t)=>({...e,children:t}),l=f((e,t)=>w(e,t)),Pt=f((e,t)=>w({...e,tag:"dialog"},t)),B=f((e,t)=>w({...e,tag:"span"},t)),j=f((e,t)=>w({...e,tag:"p"},t)),W=f((e,t)=>w({...e,tag:"a"},t)),Q=f((e,t)=>w({...e,tag:"button"},t)),kt=f((e,t)=>w({...e,tag:"ul"},t)),xt=f((e,t)=>w({...e,tag:"li"},t)),O=f(e=>w({...e,tag:"img"},null)),X=f((e,t)=>w({...e,tag:"h2"},t)),Ki=f(e=>w({...e,tag:"input"},null)),$=f((e,t)=>w({...e,tag:"label"},t)),Qi=f(e=>Ki({...e,type:"checkbox"})),b=f((e,t)=>w({...e,tag:"section"},t)),Y=f((e,t)=>w({...e,tag:"article"},t)),T=f((e,t)=>w({...e,tag:"header"},t)),Zi=f((e,t)=>w({...e,tag:"footer"},t)),er=f((e,t)=>w({...e,tag:"nav"},t)),tr=f((e,t)=>w({...e,tag:"main"},t)),sr=f((e,t)=>w({...e,tag:"audio"},t)),ir=f((e,t)=>w({...e,tag:"canvas"},t));const Ct=({class:e,click:t,children:s})=>Pt({class:`prompt-panel ${e}`,click:t},[l({class:"panel-top-button-container"},[l({class:"bttn circle close",click:(i,r)=>r.close()},[l({class:"content"},[B(),B()])])]),...s]);class G extends A{render(){const t=s=>{s.target===this.panel&&this.close()};return Ct({class:this.class,click:t,children:[l({class:"touch-slider"},[l({class:"step"},[b(this.children)])])]})}open(){k.render(this,document.body),this.panel.showModal(),typeof this.activateCallBack=="function"&&this.activateCallBack()}close(){this.panel&&(this.panel.close(),this.destroy(),typeof this.deactivateCallBack=="function"&&this.deactivateCallBack())}}const rr=({class:e,click:t,children:s})=>Pt({class:`prompt-panel ${e}`,click:t},[...s]);class ar extends G{render(){return rr({class:this.class,children:[l({class:"touch-slider"},[l({class:"step"},[b(this.children)])])]})}}const nr=e=>new ar({...e,class:"orientation-panel"},[l({class:"content"},[O({src:"images/multisplode.svg",type:"image/svg+xml"}),l({class:"title-enhance"},"Landscape Orientation Needed"),j("Please rotate your device to landscape mode to play the game.")])]),y=K.add("settings"),lr="settings";y.setKey(lr);const or={audio:!1,music:!1,graphics:"medium",song:"title.mp3"};y.resume(or);class cr extends A{render(){return sr({src:this.getFilePath(),loop:!0})}getFilePath(){return"sound/music/"+this.fileName}change(t){this.fileName!==t&&(this.fileName=t,this.panel.src=this.getFilePath(),this.state.music===!0&&this.start())}afterSetup(){y.music===!0&&this.start()}setupStates(){return{remotes:[{id:"settings",music:{callBack:t=>{this.panel&&(t===!0?this.start():this.stop())}},song:{callBack:t=>{this.panel&&this.change(t)}}}]}}start(){const t=this.panel;t.volume=.6,t.play()}stop(){this.panel.pause()}}const hr=()=>typeof window.localStorage<"u",le=hr(),Lt={storage:null,setup(){return le===!0&&(this.storage=window.localStorage),this},get(e){if(le===!1)return null;const t=this.storage.getItem(e);if(typeof t<"u")return JSON.parse(t)},set(e,t){le===!0&&(t=JSON.stringify(t),this.storage.setItem(e,t))},clear(){le===!0&&this.storage.clear()}}.setup(),S={currentLevel:null,activeLevels:[],controller:null,packs:[],activePack:null,game:null,setGame(e){this.game=e},setupActivePack(){this.packs.length>0&&(this.activePack=this.packs[0],this.activeLevels=this.activePack.setupLevels())},addLevelPack(e){this.packs.push(e)},setup(){this.setupActivePack()},selectPrimaryLevel(){const e=this.getPrimaryLevel();this.setLevel(e)},getPrimaryLevel(){const e=Lt.get("lastLevel");return e?this.activeLevels[e.number-1]:this.getFirstUnlockedLevels()},getFirstUnlockedLevels(){const e=this.activeLevels;let t=!1;for(let s=0,i=e.length;s<i;s++){let r=e[s];if(r.locked===!0){if(t)return t}else if(s===i-1)return r;t=r}return e[0]},getLevelByNumber(e){const t=this.activeLevels;for(let s=0,i=t.length;s<i;s++){let r=t[s];if(e===r.level)return r}return!1},selectLevel(e,t){e&&(this.setPreviousLevel(),this.setLevel(e,t))},setLevel(e,t){const s=this.activePack;this.game.setStageLevelController(s.controller),this.currentLevel=e,s.setLevel(e,t)},setPreviousLevel(){this.currentLevel&&this.lastSelectedLevel!==this.currentLevel&&(this.lastSelectedLevel=this.currentLevel)},unlockNextLevel(){const e=this.getNextLevel();e&&e.unlock()},isNextLevelLocked(){const e=this.getNextLevel();return e?e.locked:!0},retryLevel(){this.currentLevel&&(this.currentLevel.reset(),this.selectLevel(this.currentLevel,!0))},getNextLevel(){const e=this.activeLevels;let t=this.currentLevel?e.indexOf(this.currentLevel):0;const s=t<e.length-1?++t:null;return e[s]},selectNextLevel(){const e=this.getNextLevel();e&&this.selectLevel(e)},levelSummary(){this.activePack.levelSummary()},getPreviousLevel(){const e=this.activeLevels;let t=this.currentLevel?e.indexOf(this.currentLevel):0;const s=t>0?--t:e.length-1;return e[s]},selectPreviousLevel(){const e=this.getPreviousLevel();e&&this.selectLevel(e)}},ur=(e,t)=>xt({class:"option title-text",click:(s,i)=>i.moveToSelectedElement(s.target)},e);class At extends A{constructor(){super(...arguments);d(this,"posX",0)}onCreated(){this.viewNumber=null,this.optionsArray=[],this.selection=null,this.index=0,this.moveX=0,this.startX=0,this.contact=!1}render(){return T({class:"title-container"},[kt({cache:"navContainer",class:"option-container",...this.getEvents(),map:[this.items,ur]})])}getEvents(){const s=this.start.bind(this),i=this.move.bind(this),r=this.end.bind(this);return{touchstart:s,mousedown:s,touchmove:i,mousemove:i,touchend:r,mouseup:r,mouseout:r}}setupEvents(){const s=this.resize.bind(this);return[["resize",window,s]]}afterSetup(){this.getOptions(),this.reset(),window.setTimeout(()=>this.resize(),10)}selectPrimaryStep(){const s=this.optionsArray[0];s&&this.moveToSelectedOption(s)}reset(){this.selectPrimaryStep()}getParentWidth(){if(this.panel){const s=this.panel.getBoundingClientRect();this.parentWidth=s.width}}getOptions(){let s=this.navContainer.querySelectorAll(".option");if(!s)return;s=[].slice.call(s);const i=s.map((r,a)=>({element:r,index:a}));this.optionsArray=i,this.getParentWidth()}moveToSelectedElement(s){if(!s)return;let i=this.getOptionByElement(s);i&&this.moveToSelectedOption(i)}moveToSelectedOption(s){s&&(this.selectOption(s),this.moveToElement(s.element))}moveToSelectedIndex(s){let i=this.optionsArray[s];i&&(this.selectOption(i,!0),this.moveToElement(i.element))}selectOptionByIndex(s){let i=this.optionsArray;for(let r=0,a=i.length;r<a;r++){let n=i[r];r===s&&this.selectOption(n)}return!1}getOptionByElement(s){let i=this.optionsArray;for(let r=0,a=i.length;r<a;r++){let n=i[r];if(n.element===s)return n}return!1}selectPrimaryOption(){let s=this.optionsArray[0];s&&this.selectOption(s)}selectOption(s,i){!s||s.selected===!0||(this.selection=s,s.element.classList.add("selected"),s.selected=!0,this.updateSelectOption(s),typeof this.callBackFn=="function"&&i!==!0&&this.callBackFn(s.index))}updateSelectOption(s){let i=this.optionsArray;for(let r=0,a=i.length;r<a;r++){let n=i[r];n.crumb,n!==s&&(n.element.classList.remove("selected"),n.selected=!1)}}resize(){this.getParentWidth(),this.selection&&this.moveToElement(this.selection.element)}getEventX(s){let i=0;return s&&(s.touches?i=s.touches[0].pageX:i=s.clientX||s.pageX),i}start(s){this.navContainer.classList.add("active"),this.getParentWidth(),this.contact=!0,this.startX=this.getEventX(s)-this.posX,this.move(s)}move(s){if(this.contact===!1)return!1;let i=this.getEventX(s);this.moveX=this.startX-i,this.moveX=this.moveX*-1,this.moveContainer(this.moveX),this.checkSelectedElement()}moveContainer(s){this.posX=s,this.navContainer.style.transform="translate3d("+s+"px,0,0)"}checkSelectedElement(){let s=this.parentWidth/2,i=this.optionsArray;for(let r=0,a=i.length;r<a;r++){let n=i[r];n&&this.contains(n.element,s,10)===!0&&this.selectOption(n)}}moveToElement(s){let i=this.parentWidth/2,r=s.getBoundingClientRect(),a=i-s.offsetLeft-r.width/2;this.moveContainer(a)}getElementOffset(s){let i=s.getBoundingClientRect();return{x:this.posX+s.offsetLeft,y:s.offsetTop,width:i.width,height:i.height}}contains(s,i,r){let a=this.getElementOffset(s);return a.x<=i&&a.x+a.width>=i&&a.y<=r&&a.y+a.height>=r}end(s){if(this.contact===!0){this.navContainer.classList.remove("active"),this.contact=!1,this.parentWidth/2;let i=this.selection.element;this.moveToElement(i)}}}class me{static getEventPosition(t){const s={x:0,y:0};if(t){const i=t.touches;if(i){const r=i[0];s.x=r.pageX,s.y=r.pageY}else s.x=t.clientX||t.pageX,s.y=t.clientY||t.pageY}return s}static calculateAngle(){const t=this.startX-this.moveX,s=this.moveY-this.startY,i=Math.atan2(s,t);let r=Math.round(i*180/Math.PI);return r<0&&(r=360-Math.abs(r)),r}static getSwipeDirection(t){let s;return t<=45&&t>=0||t<=360&&t>=315?s="left":t>=135&&t<=225?s="right":t>45&&t<135?s="down":s="up",s}static isLeftRight(){const t=this.calculateAngle(),s=this.getSwipeDirection(t);return s==="left"||s==="right"}}const Tt="step",dr=(e,t)=>b({class:Tt},[e]),pr=(e,t)=>l({...e,class:"option",onState:["index",{selected:t}],cick:(s,i)=>i.moveToSelectedIndex(t)}),fr=f((e,t)=>l({class:"crumb-container"},[l({...e,class:"number-crumb-container"},t)]));class ze extends A{constructor(){super(...arguments);d(this,"canMove",null)}onCreated(){this.viewNumber=null,this.steps=[],this.index=0,this.stepWidth=null,this.slider=null,this.minimum=72,this.moveX=0,this.startX=0,this.moveY=0,this.startY=0,this.contact=!1,this.preventTouch=!1,this.preventScroll=!1}render(){return Y({class:"touch-slider step-container"},[l({cache:"slider",class:"step-slider-container",...this.getEvents(),map:[this.items,dr]}),fr({map:[this.items,pr]})])}setupStates(){return{index:this.index}}getEvents(){const s=this.start.bind(this),i=this.move.bind(this),r=this.end.bind(this);return{touchstart:s,mousedown:s,touchmove:i,mousemove:i,touchend:r,mouseup:r,mouseout:r}}setupEvents(){const s=this.getStepWidth.bind(this);return[["resize",window,s]]}afterSetup(){this.getSteps(),this.selectPrimaryStep()}getSteps(){let s=this.slider.querySelectorAll("."+Tt);if(!s)return;s=[].slice.call(s);const i=s.map((r,a)=>({ele:r,index:a}));this.steps=i,this.getStepWidth()}moveToSelectedElement(s){if(!s)return;const i=this.getStepByElement(s);i&&this.moveToSelectedStep(i)}moveToSelectedStep(s){if(!s)return;this.getStepWidth();const i=this.stepWidth*s.index;this.moveContainer("-"+i),this.index=s.index,this.state.index=s.index,this.selectStep(s)}moveToSelectedIndex(s){const i=this.steps[s];if(!i)return;this.getStepWidth();const r=this.stepWidth*i.index;this.moveContainer("-"+r),this.index=i.index,this.state.index=i.index,this.selectStep(i,!0)}selectStepByIndex(s){const i=this.steps;for(let r=0,a=i.length;r<a;r++){const n=i[r];if(r===s)return this.selectStep(n),!0}return!1}getStepByElement(s){const i=this.steps;for(let r=0,a=i.length;r<a;r++){const n=i[r];if(n.ele===s)return n}return!1}selectPrimaryStep(){const s=this.steps[0];s&&this.selectStep(s)}selectStep(s,i){s&&(s.ele.classList.add("active"),this.updateSelectStep(s),typeof this.callBackFn=="function"&&i!==!0&&this.callBackFn(s.index))}updateSelectStep(s){const i=this.steps;for(let r=0,a=i.length;r<a;r++){const n=i[r],o=n.crumb,c=n!==s;c&&n.ele.classList.remove("active"),o&&(o.className=c?"option circle selected":"option circle")}}getStepWidth(){const s=this.steps;if(!s)return;let i;if(this.viewNumber===null)i=s[0].ele.offsetWidth;else{const r=this.slider.offsetWidth;i=this.stepWidth=r/this.viewNumber;let a;for(let n=0,o=s.length;n<o;n++)a=s[n],a&&(a.style.width=i+"px");i=this.stepWidth=r/this.viewNumber}this.stepWidth=i}shouldMove(){return this.canMove===null&&(this.canMove=me.isLeftRight()),this.canMove}start(s){this.preventTouch,this.slider.classList.add("active"),this.getStepWidth(),this.contact=!0;const i=me.getEventPosition(s);this.startX=i.x,this.startY=i.y,this.move(s)}move(s){if(this.preventTouch!==!1||this.contact===!1)return!1;const i=me.getEventPosition(s);let r=i.x;if(this.moveX=this.index*this.stepWidth+(this.startX-r),this.moveY=i.y,Math.abs(this.moveX)<=this.minimum)return!1;this.shouldMove(),this.moveX=this.moveX*-1,this.moveContainer(this.moveX)}moveContainer(s){this.slider.style.transform="translate3d("+s+"px,0,0)"}end(s){if(this.contact===!0){if(this.slider.classList.remove("active"),this.contact=!1,this.moveX<=0){const i=Math.abs(this.index*this.stepWidth-this.moveX);this.moveX=Math.abs(this.moveX),i>this.stepWidth/3&&(this.moveX>this.index*this.stepWidth&&this.index<this.steps.length-1?this.index++:this.moveX<this.index*this.stepWidth&&this.index>0&&this.index--),this.selectStepByIndex(this.index)}this.moveContainer("-"+this.index*this.stepWidth)}this.state.index=this.index,this.canMove=null,this.preventTouch=!1}}class te extends A{render(){return this.children[0]}update(t){}}function mr(e){this.parent.nav&&this.parent.nav.moveToSelectedIndex(e)}function gr(e){this.parent.touch&&this.parent.touch.moveToSelectedIndex(e)}const vr=e=>{let t=e.locked===!1?" unlocked":"";return e===S.currentLevel&&(t+=" selected"),"bttn option circle fadeIn"+t},yr=e=>{const t=vr(e);return Q({class:t,click:(s,{parent:i})=>!e.locked&&i.game.selectLevel(e)},[l({class:"content"},String(e.number))])},br=({game:e})=>new te({game:e},[Y({class:"control-sub-panel level-select-container overlay-panel"},[b({class:"home-sub-panel level-select-panel"},[l({class:"panel-top-button-container floatUpZBounce"},[W({class:"bttn circle close",href:"/"},[l({class:"content"},[B(),B()])])]),new At({cache:"nav",callBackFn:gr,items:["Level Select"]}),l({class:"main-step-container"},[new ze({cache:"touch",callBackFn:mr,items:[l({class:"content",map:[S.activeLevels,yr]})]})])])])]);class wr extends A{onCreated(){this.duration??(this.duration=4e3),this.timer=null}render(){return l({class:`flash-panel dropInBounce ${this.type}`},[Zi({class:"button-container"},[Q({class:"bttn circle close",onclick:()=>this.destroy()},[l({class:"content"},[B(),B()])])]),l({class:"icon-container"}),T({class:"title-container"},[l({class:"title left dark"},this.title),l({class:"description center dark"},this.description)])])}afterSetup(){this.timer=setTimeout(()=>this.destroy(),this.duration)}start(t){k.render(this,t)}}const re=Math.PI*2,Ge=180/Math.PI,qe=Math.PI/180,v={randomFromTo(e,t,s){return s=typeof s<"u"?!0:s,s?this.floor(Math.random()*(t-e+1)+e):Math.random()*(t-e+1)+e},arc:re,checkCircluarCollision(e,t,s,i,r,a){const n=e-i,o=t-r;return n*n+o*o<=(s+a)*(s+a)},getOrbitPosition(e,t,s,i){return{x:e+Math.cos(s)*i,y:t+Math.sin(s)*i}},updateOrbitAngle(e,t,s){return s=typeof s>"u"?!0:s,s?e+t:e-t},spiral(e,t){return e+t},degreesPI:Ge,getDegrees(e){return e*Ge},radiansPI:qe,getRadians(e){return e*qe},getSlope(e,t,s,i){const r=e-s;return(t-i)/r},getAngle(e,t,s,i){const r=e-s,a=t-i,n=Math.atan2(a,r);return this.getDegrees(n)},getPositionByAngle(e,t){const s=this.getRadians(e);return{x:Math.cos(s)*t,y:Math.sin(s)*t}},getDistance(e,t,s,i){const r=e-s,a=t-i;return Math.sqrt(r*r+a*a)},getNextPosition(e,t,s,i,r){const a=this.getDistance(e,t,s,i),n=this.getMovementBySpeed(a,r);return{x:(s-e)/n,y:(i-t)/n}},distance(e,t){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},getMovementBySpeed(e,t){return e/t},round(e){return~~(.5+e)},floor(e){return~~e}},Et={options:[],messages:{awful:[],bad:[],good:[],close:[],great:[]},reset(){this.options=[]},setup(){const e=this.messages,t=(s,i,r)=>{const a={title:i,text:r};e[s].push(a)};t("awful","Whaaaa?","Let's just pretend this didn't happen..."),t("awful","Umm...","I've stopped watching already. Let's try again"),t("awful","Uhhh...","Houston, we have a problem"),t("awful","Achievement unlocked (not really)","Being this bad has to be rewarded..."),t("awful","Maybe next time...","Just click retry and don't look back"),t("bad","Brah","It's like you weren't even looking at the screen"),t("bad","Bad you did","These are not the scores you are looking for"),t("bad","Someone once told me","Just keep trying. Just keep trying."),t("bad","Yikes","You should try searching for the Konami Code"),t("bad","Like a car in a hotel room...",'You just wonder "How did this happen?"'),t("close","Almost","So close yet so far away!"),t("close","This level is even more difficult than...","That time I tried to be Batman"),t("close","There has got to be","A skip button around here somewhere"),t("close","You will beat it..","Eggs or batter maybe... but this level not likely."),t("good","Done and done!","You must have studied winning in college"),t("good","Another one bites the dust","Keep up the good work!"),t("good","Impressive","Your efforts are rewarded"),t("good","Are you a torch?","Because you are on fire!"),t("good","Crank it up",'Someone must have turned you to "eleven"'),t("good","Ahhh","You complete me"),t("good","You are more dedicated than...","A hobbit with a gold ring!"),t("good","Good job","That'll do, Player. That'll do"),t("good","Tears of joy","You make me so proud sometimes!"),t("great","New high score!","Practice does make perfect"),t("great","Living legend","Nobody will beat that score!"),t("great","Cat like reflexes","You must be a ninja!"),t("great","You are","King of the world!")},getRandomMessage(e){const t=this.messages[e];if(!t)return;const s=t.length,i=v.round(Math.random()*(s-1)),r=t[i];return r.type=e,r},getAll(){return this.options},removeAll(){const e=this.options,t=e.length;if(t)for(let s=0;s<t;s++){let i=e[s];this.remove(i)}},remove(e){const t=this.options,s=t.indexOf(e);s>-1&&(e.remove(),t.splice(s,1))}};Et.setup();const Sr=e=>{let t;if(e.scorePoints>e.highScorePoints&&e.scoreNumber>=e.minimum?t="great":e.scoreNumber>=e.minimum?t="good":e.scoreNumber>=e.minimum-4&&e.scoreNumber<=e.minimum-1?t="close":e.scoreNumber==0?t="awful":e.scoreNumber<=v.round(e.minimum*.25)&&(t="bad"),t)return Pr(t)},Pr=e=>Et.getRandomMessage(e);class Ot{constructor(t,s){this.timer=null,this.duration=t,this.callback=s}setupTimer(){this.timer=window.setTimeout(()=>this.callCallback(),this.duration)}start(){this.stop(),this.setupTimer()}stop(){window.clearTimeout(this.timer)}callCallback(){typeof this.callback=="function"&&this.callback()}}function kr(){const e=this.game.getCurrentLevel();this.data=e.data,this.data.nextLevel=e.passed||!S.isNextLevelLocked(),this.data.previousLevel=e.number>1}function xr(){const e=this.game.getCurrentLevel();e.number<S.activeLevels.length&&(e.passed&&S.unlockNextLevel(),this.state.nextLevel=e.passed||S.isNextLevelLocked());const t=Sr(e);t&&new Ot(500,()=>{new wr({type:t.type,title:t.title,description:t.text}).start(this.panel)}).start();const s=document.getElementById("summary-ad-banner-container");s&&(s.innerHTML=`
			<ins class="adsbygoogle"
					style="display:block"
					data-ad-client="ca-pub-6195383735030855"
					data-ad-slot="6511131121"
					data-ad-format="auto"
					data-full-width-responsive="true"></ins>
		`,(adsbygoogle=window.adsbygoogle||[]).push({}))}function Cr(){const e=this.game.getCurrentLevel(),{number:t,passed:s,highScorePoints:i,highScoreNumber:r,particles:a,scoreNumber:n,scorePoints:o,minimum:c,quantity:h}=e;return{number:t,passed:s,highScorePoints:i,highScoreNumber:r,particles:a,scoreNumber:n,scorePoints:o,minimum:c,quantity:h,nextLevel:!1,previousLevel:t>1}}const Bt=({game:e})=>new te({game:e,beforeSetup:kr,afterSetup:xr,setupStates:Cr},[l({class:"level-summary-container overlay-panel floatDownZ"},[l({class:"panel-top-button-container"},[W({class:"bttn circle bttn-home",href:"/"},[l({class:"content"})])]),Y({class:"summary-col-container"},[b({class:"col marketing-container",id:"summary-ad-banner-container"}),b({class:"col data-container"},[l({class:"level-summary"},[l({class:"row"},[l({class:"level-number-container pullDown"},[l({class:"level-number title-text"},"[[number]]"),l({class:"level-label title-text"},"Level")]),l({id:"summaryLevelStatus",class:"level-status title-enhance",onSet:["passed",t=>t?"Congrats, You Passed":"Sorry, Try Again"]}),l({class:"destroyed-summary",onSet:["passed",{pass:!0,fail:!1}]},[l({class:"destroyed"},[l({class:"label title-text"},"Particle Total"),l({class:"value"},"[[quantity]]"),l({class:"label title-text"},"Destroyed"),l({class:"value"},"[[scoreNumber]]")])])]),l({class:"row"},[l({class:"score-container"},[l({class:"score-panel"},[l({class:"col"},[l({class:"data underline"},[l({class:"value title-text"},"[[minimum]]"),l({class:"label title-enhance"},"Minimum")])]),l({class:"col"},[l({class:"data circle level-score"},[l({class:"content"},[l({class:"value title-text"},"[[scorePoints]]"),l({class:"label title-enhance"},"Level Score")])])]),l({class:"col"},[l({class:"data high-score underline"},[l({class:"value title-text"},"[[highScorePoints]]"),l({class:"label title-enhance"},"Highest Score")])])])])]),l({class:"row summary-button-container"},[l({class:"summary-buttons"},[l({class:"col"},[b({class:"option-group",id:"previous_level"},[l({class:"bttn circle bttn-prev",onSet:["previousLevel",{hidden:!1}],click:()=>e.previousLevel()},[l({class:"content"})]),l({class:"label title-text"},"Previous")])]),l({class:"col"},[b({class:"option-group",id:"retry_level"},[l({class:"bttn circle bttn-retry",click:()=>e.retryLevel()},[l({class:"content"})]),l({class:"label title-text"},"Retry")])]),l({class:"col"},[b({class:"option-group",id:"next_level"},[l({class:"bttn circle bttn-next",onSet:["nextLevel",{hidden:!1}],click:()=>e.nextLevel()},[l({class:"content"})]),l({class:"label title-text"},"Next")])])])])])])])])]);function Lr(){this.game.stopStage(),y.song="summary-loop.mp3"}const Ar=({game:e})=>new te({game:e,afterSetup:Lr},[l({class:"control-sub-panel pause-container overlay-panel"},[l({class:"pause-panel floatDownZ"},[Q({class:"play circle",click:()=>e.resume()},[l({class:"content"})])]),Y({class:"options-container fadeIn"},[b({class:"option-group"},[W({class:"bttn circle bttn-home",href:"/"},[l({class:"content"})]),l({class:"label title-text"},"Home")]),b({class:"option-group"},[W({class:"bttn circle bttn-levels",href:"/levels"},[l({class:"content"})]),l({class:"label title-text"},"Levels")]),b({class:"option-group"},[l({class:"bttn circle bttn-retry",click:()=>e.retryLevel()},[l({class:"content"})]),l({class:"label title-text"},"Retry")])])])]);class Tr{constructor(t,s){this.options=t,this.callBack=s,this.selection=null}get(t){return this.options[t]||!1}getSelectedIndex(){return typeof this.selectedIndex<"u"?this.selectedIndex:0}next(){let t=this.getSelectedIndex();const s=t<this.options.length-1?++t:0;return this.select(s)}previous(){let t=this.getSelectedIndex();const s=t>0?--t:this.options.length-1;return this.select(s)}select(t){const s=this.get(t);return s!==!1&&(this.selection=s,this.selectedIndex=t,this.callBack&&this.callBack(s)),s}selectOption(t){const s=this.options.indexOf(t);return s>-1&&(t=this.select(s)),t}}class Er extends A{onCreated(){this.iterator=new Tr(this.options,this.change.bind(this)),this.iterator.selectOption(this.data[this.dataProp])}render(){return l({class:"value-container"},[Q({class:"value-button arrow prev",click:this.previous.bind(this)}),Q({class:"value-button",click:this.next.bind(this)},"[["+this.dataProp+"]]"),Q({class:"value-button arrow next",click:this.next.bind(this)})])}change(t){this.data.set(this.dataProp,t),this.data.store()}next(){this.iterator.next()}previous(){this.iterator.previous()}}class Ve extends A{render(){const t=this.getId("checkbox");return l({class:"data-toggle-panel"},[Qi({id:t,cache:"checkbox",class:"toggle",change:this.change.bind(this),checked:this.checked}),$({class:"toggle-bttn",htmlFor:t})])}isChecked(t){return this.checkbox.checked}change(){this.checked=this.isChecked(),this.callBack&&this.callBack(this.checked)}toggle(){const t=this.isChecked();this.checkbox.checked=!t}}class Or extends te{}function Br(e){this.parent.nav&&this.parent.nav.moveToSelectedIndex(e)}function Dr(e){this.parent.touch&&this.parent.touch.moveToSelectedIndex(e)}const jr=e=>new Or([Y({class:"control-sub-panel settings-container overlay-panel",animateIn:"maskInTop"},[b({class:"home-sub-panel settings-panel"},[l({class:"panel-top-button-container floatUpZBounce"},[W({class:"bttn circle close",href:"/"},[l({class:"content"},[B(),B()])])]),new At({cache:"nav",callBackFn:Dr,items:["audio","video","about"]}),l({class:"main-step-container"},[new ze({cache:"touch",callBackFn:Br,items:[l({class:"content settings-sub-panel audio-container"},[T({class:"title-text"},"Audio"),l({class:"row"},[$({class:"title"},"Music"),l({class:"value-container"},[new Ve({checked:y.music,callBack:t=>{y.music=!!t,y.store()}})])]),l({class:"row"},[$({class:"title"},"Sound fx"),l({class:"value-container"},[new Ve({checked:y.audio,callBack:t=>{y.audio=!!t,y.store()}})])])]),l({class:"content settings-sub-panel audio-container"},[T({class:"title-text"},"Video"),l({class:"row"},[$({class:"title"},"Graphics"),new Er({data:y,dataProp:"graphics",options:["low","medium","high"]})])]),l({class:"content settings-sub-panel about-container"},[T({class:"title-text"},"Credits"),l({class:"row"},[$({class:"title"},"Programming"),l({class:"value-container"},"Chris Durfee")]),l({class:"row"},[$({class:"title"},"Graphic Design"),l({class:"value-container"},"Chelsea Durfee")]),l({class:"row"},[$({class:"title"},"Music & Sound"),l({class:"value-container"},"Chris Durfee")])])]})])])])]);function Ir(){y.song="title.mp3",window.setTimeout(()=>{this.panel.classList.remove("loading")},300)}const Nr=({game:e})=>new te({afterSetup:Ir},[b({class:"main-home-panel overlay-panel loading"},[l({class:"background background-stars"}),l({class:"panel-top-button-container"},[W({class:"bttn circle settings",href:"/settings"},[l({class:"content"})])]),Y({class:"home-base-panel"},[l({class:"row logo-container"},[l({class:"background background-mask"}),l({class:"game-name-container"},[O({src:"images/multisplode.svg"})])]),l({class:"row menu-container"},[b({class:"col main-menu-container clear"},[l({class:"game-menu-container"},[l({class:"main-nav-container"},[er([kt({class:"clear"},[xt([W({class:"bttn main-play title-text",href:"/play",click:t=>{t.preventDefault(),e.startGame()}},"Play")])])])])])])])])])]),Rr=`<svg id="level-progress-image" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 83.2 83.6" width="83px" height="83px">
<style>
	.progress-bg{opacity:0.2;fill:#FFFFFF;stroke-width:0px;enable-background:new ;} .progress{fill:none;stroke:#FF4881;stroke-width:4;stroke-miterlimit:10;}
</style>
<path class="progress-bg" d="M74.7 21L62.2 8.5C50.9-2.8 32.3-2.8 21 8.5L8.5 21c-11.3 11.3-11.3 29.9 0 41.2L21 74.7C32.3 86 50.9 86 62.2 74.7l12.5-12.5C86 50.9 86 32.3 74.7 21zm-3.3 39.1L60.1 71.4c-10.2 10.2-26.9 10.2-37.1 0L11.8 60.1C1.6 49.9 1.6 33.2 11.8 23L23 11.8c10.2-10.2 26.9-10.2 37.1 0L71.4 23c10.2 10.2 10.2 26.9 0 37.1z"/>
<path id="progress-line" class="progress" d="M60.82 72.582c-10.606 10.605-27.968 10.605-38.572 0L10.603 60.834c-10.605-10.605-10.605-27.967 0-38.57l11.644-11.645C32.852.013 50.214.013 60.817 10.62l11.75 11.643c10.604 10.605 10.604 27.967 0 38.57l-11.748 11.75"/>
</svg>`;class zr extends A{beforeSetup(){const t=this.game.getCurrentLevel();this.data=t.data,this.length=0,this.progress=0}render(){return l({class:"progress-bar",onSet:["scoreNumber",t=>this.update(t,this.data.minimum)],html:Rr})}afterSetup(){window.setTimeout(()=>{const s=this.element=document.getElementById("progress-line"),i=this.length=s.getTotalLength();s.style.strokeDasharray=i+" "+i,this.changeStrokeOffset(i),window.setTimeout(()=>{this.reset()},150)},10)}modifyTransition(t){this.element.style.transition="stroke-dashoffset "+t+"ms linear"}update(t,s){let i=t/s*100/100;if(i=i<1?i.toFixed(2):1,i===1&&this.progress!==i||i!==this.progress){const r=this.length,a=r-r*i;this.changeStrokeOffset(a),this.progress=i}}changeStrokeOffset(t){this.element&&(this.element.style.strokeDashoffset=String(t))}reset(){const t=this.length;this.changeStrokeOffset(t),this.modifyTransition(150)}beforeDestroy(){this.modifyTransition(0)}}const Mr=(e,t,s)=>{const i=e.type||"Shockwave";return l({class:"touch-icon circle "+i.toLowerCase(),onSet:[s,"selected",{inactive:!0}]})};class Fr extends A{beforeSetup(){const t=this.game.getCurrentLevel();this.level=t,this.level.setUpdateTouchCallBack(()=>this.select()),this.data=new ae,this.reset()}render(){return b({class:"option-group level-touches"},[l({id:"levelTouches",cache:"levelTouces",class:"value touch-container title-text",for:["touches",Mr]}),l({class:"label title-text"},"Touches")])}setupTouches(){const t=this.level.devices,s=[];for(let i in t){const r=t[i];for(let a=0;a<r;a++)this.limit++,s.push({type:i,selected:!1})}return s}select(){let t=!1;if(this.current>=0){const i=this.data.touches[this.current];i.selected===!1&&(t=i,i.selected=!0,this.current--)}return t}reset(){this.limit=0,this.data.set("touches",this.setupTouches()),this.current=this.limit-1}}function Wr(){console.log("PlayPage: beforeSetup called");let e=this.game.getCurrentLevel();e||(console.log("PlayPage: No current level, selecting primary level"),S.selectPrimaryLevel(),y.song="play-loop.mp3",e=this.game.getCurrentLevel()),this.data=e.data,console.log("PlayPage: Setup complete, level:",e==null?void 0:e.level)}function _r(){const e=this.game.getCurrentLevel();this.panel.classList.add(e.levelClass)}function Hr(){this.game.stopStage()}const Ur=({game:e})=>new te({game:e,beforeSetup:Wr,afterSetup:_r,beforeDestroy:Hr},[b({class:"play-container"},[l({class:"play-panel"},[l({class:"fade-layer"},[ir({id:"portal",cache:"portal",class:"main-canvas",onCreated(t){e.setCanvas(t),window.setTimeout(()=>{e.setupStage(),e.startStage()},1)}})])]),l({class:"play-level-container"},[l({class:"level-guide fadeIn"},[Y({class:"options-container"},[l({class:"top-container"},[b({class:"option-group"},[W({class:"bttn circle bttn-pause",href:"/play/paused"},[l({class:"content"},[B(),B()])])]),b({class:"option-group level-number"},[l({id:"levelNumber",class:"value title-text"},"[[number]]"),l({class:"label title-text"},"Level")])]),l({class:"lower-container"},[b({class:"option-group level-progress"},[l({id:"levelProgress",class:"value progress title-text"},[l({id:"levelMinimum",class:"progress-number value title-text"},"[[remaining]]"),new zr({game:e})]),l({class:"label title-text"},"Progress")]),new Fr({cache:"touches",game:e})])])]),l({id:"fps",class:"fps"})])])]),ge=(e,t,s)=>({uri:e,component:t,title:s}),$r=e=>[ge("/play/:state?",Ur(e),"Play"),ge("/level-summary",Bt(e),"Level Summary"),ge("/:overlay?",Nr(e),"Home")],Xr=f((e,t)=>tr({class:"main-game-container",...e},t)),Yr=f((e,t)=>({class:"main-container",...e,children:t})),Gr=e=>Xr([Yr({cache:"mainBody",switch:$r(e)}),l({class:"overlay-container",route:[{uri:"/settings",component:jr()},{uri:"/levels",component:br(e)},{uri:"/play/paused",component:Ar(e)},{uri:"/play/level-summary",component:Bt(e)}]}),new cr({cache:"soundFx",class:"sound",fileName:"title.mp3"})]),ce={size:{width:774,height:493},router:{baseUrl:"/",title:"Multisplode"}},qr=e=>new G({class:"startup-panel",...e},[l({class:"content"},[O({src:"images/four-more.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Four Is More")]),j("You can now use four explosions at anytime to maximize the destruction.")])]),Vr=e=>new G({class:"startup-panel",...e},[l({class:"content"},[O({src:"images/three-more.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Three Is More Fun")]),j("You can now use three explosions at anytime to maximize the destruction.")])]),Jr=e=>new G({class:"startup-panel",...e},[l({class:"content"},[O({src:"images/double-trouble.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Double The Trouble")]),j("You can now use two explosions at anytime to maximize the destruction.")])]),Kr=e=>new G({class:"startup-panel",...e},[l({class:"content"},[O({src:"images/gravity-field.svg",type:"image/svg+xml"}),l({class:"title-enhance"},"Gravity Doesn't Suck"),j("You can now use gravity to your advantage. Gravity fields attract particles and lock them into orbit until the gravity field becomes too weak and the particles are released.")])]),Qr=e=>new G({class:"startup-panel",...e},[l({class:"content"},[O({src:"images/complete-challenge.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Pulse Particles")]),j("The pulse particle is pure white and packs a punch. It causes 1.5X destruction and double the points.")])]);class Zr extends G{render(){const t=s=>{s.target===this.panel&&this.close()};return Ct({class:this.class,click:t,children:[new ze({cache:"touch",items:this.children})]})}}const ea=e=>new Zr({class:"startup-panel",...e},[l({class:"content"},[O({src:"images/destroy-particles.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Destroy The Particles")]),j("Touch the screen to create an explosion. Particles that hit explosions will also explode creating chains.")]),l({class:"content"},[O({src:"images/complete-challenge.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Complete The Challenge")]),j("Beat the level minimum to continue. As the levels go on the explosions will get smaller increasing the difficulty.")]),l({class:"content"},[O({src:"images/unlock-explosions.svg",type:"image/svg+xml"}),T({class:"title-enhance"},[X("Unlock Multiple Explosions")]),j("As the levels progress they will require more than just one explosion to complete the challenge.")])]),ta={StartupPrompt:ea,AddTwoPrompt:Jr,AddThreePrompt:Vr,AddFourPrompt:qr,PulseParticlePrompt:Qr,GravityFieldPrompt:Kr},sa=e=>{try{const t=ta[e.type];return t(e)}catch(t){console.log(t)}return null},Le={prompts:{},game:null,setGame(e){this.game=e},setup(){const e=()=>this.game.stopDraw(),t=()=>this.game.startDraw();this.add({type:"StartupPrompt",activateCallBack:e,deactivateCallBack:t}),this.add({type:"AddTwoPrompt",activateCallBack:e,deactivateCallBack:t}),this.add({type:"AddThreePrompt",activateCallBack:e,deactivateCallBack:t}),this.add({type:"AddFourPrompt",activateCallBack:e,deactivateCallBack:t}),this.add({type:"PulseParticlePrompt",activateCallBack:e,deactivateCallBack:t}),this.add({type:"GravityFieldPrompt",activateCallBack:e,deactivateCallBack:t})},getPrompt(e){return this.prompts[e]||null},showPrompt(e){const t=this.getPrompt(e);t&&t.open()},reset(){this.prompts=[]},getAll(){return this.prompts},add(e){const t=sa(e);return t?(this.prompts[e.type]=t,t):!1},remove(e){const t=this.prompts.indexOf(e);t>-1&&this.prompts.splice(t,1)}};class Dt{constructor(t,s,i,r,a,n,o,c,h){d(this,"isAtLimit",!1);d(this,"timerUi",null);d(this,"timerUiDelay",150);this.number=t,this.touch=0,this.touchLimit=0,this.devices={},this.setupDevices(s),this.minimum=i,this.afterTouch=r,this.afterTouchReady="no",this.particles=null,this.setupParticleCount(a),this.waveScale=n,this.waveMaxSize=o,this.remaining=this.minimum,this.passed=!1,this.currentNumber=0,this.scoreNumber=0,this.scorePoints=0,this.highScorePoints=0,this.highScoreNumber=0,this.originalDelay=null,this.updateTouchCallBack=null,this.promptId=c,this.levelClass=h,this.bestTime="",this.locked=!0,this.setData()}setData(){this.data=new ae,this.setDataValues(),this.data.setKey("level-"+this.number),this.data.resume(),this.data.passed=!1,this.data.remaining=this.minimum}setDataValues(){this.data.set({number:this.number,locked:this.locked,minimum:this.minimum,remaining:this.minimum,scoreNumber:this.scoreNumber,quantity:this.quantity,scorePoints:this.scorePoints,highScorePoints:this.highScorePoints,highScoreNumber:this.highScoreNumber,bestTime:this.bestTime,devices:this.devices,passed:!1})}setup(){this.updateFromData(),this.reset(),this.number===1&&this.unlock()}setupDevices(t){if(typeof t!="object"){this.devices={ShockWave:t},this.touchLimit=t;return}this.touchLimit=0;for(let s=0,i=t.length;s<i;s++){let r=t[s],a="ShockWave";switch(s){case 0:a="ShockWave";break;case 1:a="GravityField";break}this.touchLimit+=r,this.devices[a]=r}}setupParticleCount(t){if(typeof t!="object"){this.quantity=t;return}this.particles=t;let s=0;for(let i in t)L.hasOwnProp(t,i)&&(s+=t?t[i]:0);this.quantity=s}reset(){this.touch=0,this.scoreNumber=0,this.scorePoints=0,this.currentNumber=0,this.afterTouchReady="no",this.remaining=this.minimum,this.passed=!1,this.isAtLimit=!1,this.setDataValues(),this.blowEm=!1,this.startDelay=null,this.isAtLimit=!1,this.delay=this.originalDelay}updateTouch(){this.touch++;const t=this.updateTouchCallBack();return this.isAtTouchLimit(),t}setUpdateTouchCallBack(t){this.updateTouchCallBack=t}isAtTouchLimit(){this.touch===this.touchLimit&&(this.isAtLimit=!0)}updateHighScore(){this.scoreNumber>this.highScoreNumber&&(this.highScoreNumber=this.scoreNumber,this.data.highScoreNumber=this.scoreNumber),this.scorePoints>this.highScorePoints&&(this.highScorePoints=this.scorePoints,this.data.highScorePoints=this.scorePoints),this.saveToData()}updateScore(t,s){this.updatePoints(s),this.updateNumber(t),this.updateUiByTimer()}updateUiByTimer(){this.timerUi===null&&(this.timerUi=window.setTimeout(()=>{this.updateRemaining(),this.updatePlayUi(),this.updateHighScore(),this.timerUi=null},this.timerUiDelay))}updateRemaining(){let t=this.minimum-this.scoreNumber;t!==this.currentNumber&&(this.currentNumber=t,t=t>0?t:0,this.data.remaining=t,t===0&&(this.passed=!0,this.data.passed=!0))}updatePoints(t){this.scorePoints+=t}updateNumber(t){this.scoreNumber+=t}updatePlayUi(){this.data.set({scoreNumber:this.scoreNumber,scorePoints:this.scorePoints})}updateBestTime(t){this.bestTime=t,this.data.bestTime=t,this.data.store()}updateFromData(){const t=this.data;t&&(this.locked=t.locked,this.highScorePoints=t.highScorePoints,this.highScoreNumber=t.highScoreNumber,this.bestTime=t.bestTime)}saveToData(){const t={locked:this.locked,highScorePoints:this.highScorePoints,highScoreNumber:this.highScoreNumber};this.data.set(t),this.data.store()}unlock(){this.locked=!1,this.data.locked=!1,this.saveToData()}}class ia{constructor(t){d(this,"controller",null);d(this,"levels",[[1,28,40,40,1,65,"startup-panel","first"]]);this.label="",this.game=t}setupLevels(){let t="";const s=[],i=this.levels;for(let r=0,a=i.length;r<a;r++){let n=i[r],o=typeof n[7]<"u"?n[7]:t;o!==t&&(t=o),s.push(this.createLevel(r+1,n,o))}return s}createLevel(t,s,i){const r=new Dt(t,s[0],s[1],s[2],s[3],s[4],s[5],s[6],i);return r.setup(),r}changeLevel(t){this.controller.changeLevel(t)}setLevel(t,s){this.changeLevel(t),this.controller.setLevel(s)}levelSummary(){this.controller.getSummary()}}const ra=(e,t,s)=>{const i=new Audio(e),r={audio:i,type:t};return i.addEventListener("ended",()=>s(r)),i.volume=.6,i.play(),r},jt={activeSounds:new Map,reset(){this.activeSounds=new Map},getAll(){return this.activeSounds.getAll()},add(e,t){if(y.audio!==!0)return!1;const s=this.remove.bind(this),i=ra(e,t,s);return this.activeSounds.set(t,i),i},check(e){const t=this.activeSounds;return t.count<1?!1:t.get(e)||!1},remove(e){this.activeSounds.delete(e.type)}},q={add(e,t,s){const i=this.createCacheCanvas(t,s),r=i.getContext("2d");return typeof e=="function"&&e(r),i},createCacheCanvas(e,t){const s=document.createElement("canvas");return s.width=e,s.height=t,s}},F=v.arc,aa=(e,t)=>({x:v.round(e),y:v.round(t)});class It{constructor(t,s,i,r){this.position=aa(t,s),this.size=0,this.fillColor=i,this.audio="sound/collisions/collision-1a.mp3",this.maxSize=0,this.multiplier=r||1,this.type="device",this.explosive=!1,this.cachePath()}checkToRemove(){return!1}cachePath(){const t=this.maxSize,s=this.lineSize=t/10,i=this.totalSize=t*2+s*2;this.half=this.totalSize/2;const r=a=>{const n=i/2;a.beginPath(),a.arc(n,n,t,0,F,!0),a.globalAlpha=.3,a.fillStyle=this.fillColor,a.fill(),a.globalAlpha=.5,a.beginPath(),a.arc(n,n,t*.3,0,F,!0),a.fillStyle=this.fillColor,a.fill(),a.globalAlpha=.7,a.beginPath(),a.arc(n,n,t*.6,0,F,!0),a.fillStyle=this.fillColor,a.fill(),a.globalAlpha=1};this.cache=q.add(r,i,i)}draw(t){const s=this.position.x,i=this.position.y,r=this.size/this.maxSize;t.save(),t.translate(s,i),t.scale(r,r),t.drawImage(this.cache,-this.half,-this.half),t.restore()}}class na extends It{constructor(t,s,i,r){super(t,s,i,r),this.audio="sound/collisions/collision-1a.mp3",this.gravity=1*this.multiplier,this.startTime=null,this.time=8e3,this.delta=0,this.maxSize=0,this.totalSize=0,this.lineSize=0,this.type="gravityField",this.getMaxSize(),this.cachePath()}checkToRemove(){const t=this.getStartTime();return this.delta=Number(new Date)-t,this.delta>=this.time}getStartTime(){return this.startTime=this.startTime||new Date,this.startTime}updateParticlePosition(t){let s=this.position,i=t.position,a=v.distance(i,s)-this.gravity-this.gravity;a=a>this.orbitLimit?a:this.orbitLimit;const n=v.updateOrbitAngle(this.getOrbitAngle(t),t.speed/this.size);s=v.getOrbitPosition(s.x,s.y,n,a),i.x=s.x,i.y=s.y}getOrbitAngle(t){const s=this.position,i=t.position,r=i.x-s.x,a=i.y-s.y;return Math.atan2(a,r)}orbitParticle(t){this.updateParticlePosition(t)}getMaxSize(){const t=S.currentLevel;t&&(this.maxSize=t.waveMaxSize*this.multiplier,this.size=this.maxSize,this.orbitLimit=this.maxSize-this.maxSize/3)}cachePath(){const t=this.maxSize,s=this.lineSize=2,i=this.totalSize=t*2+s*2;this.half=this.totalSize/2;const r=a=>{const n=i/2;a.beginPath(),a.arc(n,n,t,0,F,!0),a.globalAlpha=.3,a.fillStyle=this.fillColor,a.fill(),a.lineWidth=2,a.strokeStyle="#FFF",a.stroke(),a.globalAlpha=.7,a.beginPath(),a.arc(n,n,t*.2,0,F,!0),a.fillStyle=this.fillColor,a.fill(),a.globalAlpha=1};this.cache=q.add(r,i,i)}draw(t){const s=1-this.delta/this.time;t.save(),t.translate(this.position.x,this.position.y),t.globalAlpha=s,t.drawImage(this.cache,-this.half,-this.half),t.restore()}}const Nt=["collision-1a.mp3","collision-1b.mp3","collision-1c.mp3","collision-1d.mp3"],la=Nt.length-1,oa=()=>{const e=v.round(Math.random()*la);return Nt[e]};class ca extends It{constructor(s,i,r,a){super(s,i,r,a);d(this,"waveScale",0);d(this,"maxSize",0);d(this,"totalSize",0);d(this,"lineSize",0);this.size=0;const n=oa();this.audio=`sound/collisions/${n}`,this.type="shockWave",this.explosive=!0,this.getWaveScale(),this.cachePath()}updateSize(){this.size+=this.waveScale}checkToRemove(){return this.size>=this.maxSize}getWaveScale(){const s=S.currentLevel;s&&(this.waveScale=s.waveScale,this.maxSize=s.waveMaxSize*this.multiplier)}cachePath(){const s=this.maxSize,i=this.lineSize=s/10,r=this.totalSize=s*2+i*2;this.half=this.totalSize/2;const a=n=>{let o=r/2;n.beginPath(),n.arc(o,o,s,0,F,!0),n.globalAlpha=.3,n.fillStyle=this.fillColor,n.fill(),n.globalAlpha=.5,n.beginPath(),n.arc(o,o,s*.3,0,F,!0),n.fillStyle=this.fillColor,n.fill(),n.globalAlpha=.7,n.beginPath(),n.arc(o,o,s*.6,0,F,!0),n.fillStyle=this.fillColor,n.fill(),n.globalAlpha=1};this.cache=q.add(a,r,r)}draw(s){this.updateSize();const i=this.size/this.maxSize;s.save(),s.translate(this.position.x,this.position.y),s.scale(i,i),s.drawImage(this.cache,-this.half,-this.half),s.restore()}}const Je={ShockWave:ca,GravityField:na},J={devices:[],removed:[],reset(){this.explosives=0,this.devices=[],this.removed=[]},explosives:0,getExplosivesCount(){return this.explosives},getAll(){return this.devices},add(e,t,s,i,r="ShockWave"){const a=Je[r]||Je.ShockWave,n=new a(e,t,s,i);return n.explosive===!0&&this.explosives++,jt.add(n.audio,r),this.devices.push(n),n},remove(e){const t=this.devices,s=t.indexOf(e);s>-1&&(t.splice(s,1),this.removed.push(e))},draw(e){e.globalCompositeOperation="lighter";const t=this.devices;for(let s=t.length-1;s>=0;s--){let i=t[s];i.checkToRemove()===!0?(i.explosive===!0&&this.explosives--,this.remove(i)):i.draw(e)}e.globalCompositeOperation=0}},ha=e=>{let t=v.floor(Math.random()*7),s="";switch(t){case 0:s="#F9322D";break;case 1:s="#FF397F";break;case 2:s="#D541B7";break;case 3:s="#FF8931";break;case 4:s="#F9F95D";break;case 5:s="#21F8B6";break;case 6:s="#26CFCE";break;case 7:s="#3153CB";break}return s};let ua=0;const U=v.randomFromTo,da=1e3/60;class Rt{constructor(t){this.type="particle",this.value=10,this.multiplier=1,this.setup(t)}init(){this.number=++ua,this.id=this.number}getDefaultSettings(){const t=ce.size,s=.005,i=.008,r=t.width*.12/da,a=U(t.width*s,t.width*i),n=a*2;return{size:a,position:{x:U(a+3,t.width-n-3),y:U(a+3,t.height-n-3)},fillColor:ha(),stroke:U(3,5),direction:U(-10,10),angle:U(0,360),speed:U(r/1.8,r)}}setup(t,s){s=s!==!1;let i=this.getDefaultSettings();t&&typeof t=="object"&&(i=Object.assign(i,t)),this.size=i.size,this.fullSize=this.size*2,this.position=i.position,this.fillColor=i.fillColor,this.stroke=i.stroke,this.direction=i.direction,this.speed=i.speed,this.angle=i.angle,s&&this.cachePath()}move(){this.updateByAngle()}updateByAngle(){this.updatePosition()}updateAngle(){const t=v.updateOrbitAngle(this.angle,this.speed);this.angle=t}checkWall(t){const s=this.position;(s.x+this.size>=t.width||s.x<=this.size)&&(this.angle=180-this.angle),(s.y+this.size>=t.height||s.y<=this.size)&&(this.angle=360-this.angle)}updatePosition(){const t=ce.size,s=v.getPositionByAngle(this.angle,this.speed),i=v.round,r=this.position;r.x=i(r.x+s.x),r.y=i(r.y+s.y),this.checkWall(t)}cachePath(){const t=Math.ceil(this.size*2),s=i=>{i.beginPath(),i.arc(t/2,t/2,this.size,0,re,!0),i.fillStyle=this.fillColor,i.fill()};this.cache=q.add(s,t,t)}hasCollided(t){const s=this.position;let i=s.x-t.position.x,r=s.y-t.position.y,a=t.size+this.size;return i*i+r*r<=a*a}draw(t){t.drawImage(this.cache,this.position.x-this.size,this.position.y-this.size)}}class pa extends Rt{constructor(t){super(t),this.type="pulse",this.value=20,this.multiplier=1.5,t||(t={}),t.size=8;const s="#FFF";t.fillColor=s,this.setup(t)}cachePath(){const t=this.size,s=t*2,i=r=>{const a=s/2;r.beginPath(),r.arc(a,a,t,0,re,!0),r.fillStyle="rgba(255,255,255,.4)",r.fill(),r.beginPath(),r.arc(a,a,t/2,0,re,!0),r.fillStyle=this.fillColor,r.fill()};this.cache=q.add(i,s,s)}}const fa={Particle:Rt,PulseParticle:pa},R={particles:[],removed:[],reset(){this.particles=[],this.removed=[]},getAll(){return this.particles},add(e,t){e=e||"Particle";const s=fa[e],i=new s(t);return this.particles.push(i),i},remove(e){const t=this.particles.indexOf(e);t<0||(this.particles.splice(t,1),this.removed.push(e))}},ve={},ma=(e,t)=>({x:e,y:t});let ga=0;class va{constructor(t,s,i){this.number=++ga,this.id=this.number,this.position=ma(t,s),this.size=16,this.fillColor="#FFFFFF",this.opacity=1,this.text="+"+i,this.value=i,this.distance=0,this.maxDistance=3,this.speed=.06,this.cachePath()}move(){this.distance+=this.speed,this.position.y-=this.distance}changeAlpha(){this.opacity-=.05}cachePath(){if(ve[this.value]){this.cache=ve[this.value];return}const t=40,s=60,i=r=>{r.font=this.size+"px Helvetica",r.fillStyle=this.fillColor,r.fillText(this.text,s/2,t/2)};this.cache=ve[this.value]=q.add(i,s,t)}draw(t){const s=v.round(this.position.x),i=v.round(this.position.y),r=1-this.distance/this.maxDistance;t.save(),t.globalAlpha=r,t.drawImage(this.cache,s,i),t.restore()}}const Ae={gamePoints:[],removed:[],reset(){this.gamePoints=[],this.removed=[]},getAll(){return this.gamePoints},add(e,t,s){const i=new va(e,t,s);return this.gamePoints.push(i),i},remove(e){const t=this.gamePoints,s=t.indexOf(e);s>-1&&(t.splice(s,1),this.removed[this.removed.length]=e)},draw(e){e.beginPath();const t=this.gamePoints;for(let s=t.length-1;s>=0;s--){let i=t[s];v.round(i.distance)>=i.maxDistance?this.remove(i):(i.move(),i.draw(e))}e.closePath()}},ya=.001;class ba{constructor(t,s,i,r,a,n){this.position={x:t,y:s},this.angle=i,this.size=v.randomFromTo(4,10),this.maxSize=this.size,this.fillColor=r,this.stroke=r,this.type="",this.speed=v.randomFromTo(1,5),this.cachePath()}updatePosition(){const t=v.getPositionByAngle(this.angle,this.speed),s=this.position;s.x+=t.x,s.y+=t.y,this.updateSize()}updateSize(){this.size-=.5}cachePath(){const t=this.totalSize=this.size*2;this.half=this.totalSize/2;const s=i=>{const r=t/2;i.globalAlpha=.7,i.beginPath(),i.arc(r,r,t,0,re,!0),i.fillStyle=this.fillColor,i.fill(),i.globalAlpha=1};this.cache=q.add(s,t,t)}draw(t){if(this.updatePosition(),this.size<ya)return!1;const s=this.position,i=this.size/this.maxSize;t.save(),t.translate(s.x,s.y),t.scale(i,i),t.drawImage(this.cache,-this.half,-this.half),t.restore()}}const wa=()=>{let e=20;switch(y.graphics){case"low":e=12;break;case"high":e=30;break}return e};class Sa{constructor(t,s,i){d(this,"radiusRate",null);this.particleNumber=wa(),this.x=t,this.y=s,this.color=i,this.radius=0,this.maxRadius=30,this.speed=20,this.particles=[],this.removed=[],this.setupParticles()}setupParticles(){const t=this.particleNumber,s=360/t;for(let i=0;i<=t;i++){let r=s*i;this.addParticle(r)}this.radiusRate=this.maxRadius/this.speed}addParticle(t){const s=new ba(this.x,this.y,t,this.color,this.maxRadius,this.speed);this.particles.push(s)}checkToRemove(){return this.radius>=this.maxRadius}updateRadius(){let t=this.radius;t+=this.radiusRate,t=v.round(t)}draw(t){this.updateRadius();const s=this.particles;for(let i=s.length-1;i>=0;i--){let r=s[i];if(r.draw(t)===!1){s.splice(i,1);let a=this.removed;a[a.length]=r}}}}const Te={sparks:[],removed:[],maxRadius:5,speed:10,reset(){this.sparks=[],this.removed=[]},add(e,t,s){const i=new Sa(e,t,s);this.sparks.push(i)},remove(e){const t=this.sparks,s=t.indexOf(e);if(s>-1){t.splice(s,1);let i=this.removed;i[i.length]=e}},updateRadius(e){e.checkToRemove()==!1?e.radius+=e.radiusRate:this.remove(e)},draw(e){const t=this.sparks;for(let s=t.length-1;s>=0;s--){let i=t[s];i&&(i.draw(e),this.updateRadius(i))}}},Pa={addAnimation(e,t,s=0){if(!e)return;const i=e.classList;i.add(t),window.setTimeout(()=>i.remove(t),s)}};class ka{constructor(){d(this,"level",null);d(this,"blowEmDelay",200);d(this,"blowEm",!1);d(this,"blowEmExtend",380);d(this,"playContainer",null);d(this,"originalDelay",1e3);d(this,"delay",1e3);d(this,"startDelay",null)}setLevel(t){this.reset(),this.setupParticles();const s=this.level;if(Lt.set("lastLevel",s),t!==!0){const i=s.promptId;i&&this.showPrompt(i)}}showPrompt(t){new Ot(50,()=>Le.showPrompt(t)).start()}changeLevel(t){this.level=t}interact(t,s){const i=this.level;if(i&&i.touch<i.touchLimit){const r=i.updateTouch();J.add(t,s,"rgba(255,255,255,.9)",1,r.type)}}createDevice(t,s,i,r=!1){J.add(t,s,i,r),this.createSparks(t,s,i)}createSparks(t,s,i){Te.add(t,s,i)}createPoints(t,s,i){const r=this.level;r&&(y.graphics==="high"&&Ae.add(t,s,i),r.updateScore(1,i))}randomFromTo(t,s){return v.floor(Math.random()*(s-t+1)+t)}reset(){this.level.reset(),jt.reset(),R.reset(),Ae.reset(),J.reset(),Te.reset(),this.blowEm=!1,this.startDelay=null,this.isAtLimit=!1,this.delay=this.originalDelay}draw(t,s){}setupParticles(){this.reset();const t=this.level,s=t.particles;if(s&&typeof s=="object"){for(let i in s)if(L.hasOwnProp(s,i)){const r=s[i];for(let a=0;a<r;a++)R.add(i)}}else for(let i=0,r=t.quantity;i<r;i++)R.add()}checkToBlowEm(){const t=this.level;t.scoreNumber>=t.minimum&&(this.destroyAllParticles(),this.delay+=this.blowEmExtend,this.playContainer===null&&(this.playContainer=document.querySelector(".play-container")),Pa.addAnimation(this.playContainer,"shakePanel",600)),this.blowEm=!0}setupCompleteDelay(){return this.startDelay=this.startDelay||new Date,this.startDelay}checkLevelComplete(t){if(this.level.isAtLimit===!0&&J.getExplosivesCount()<1||t<1){const s=this.setupCompleteDelay(),i=Number(new Date)-Number(s);if(this.blowEm===!1&&i>=this.blowEmDelay)this.checkToBlowEm();else if(i>=this.delay)return R.reset(),!0}return!1}isComplete(t){return this.checkLevelComplete(t)}destroyAllParticles(){const t=R.getAll(),s=t.length;if(t)for(let i=s-1;i>=0;i--){const r=t[i];R.remove(r),this.createDevice(r.position.x,r.position.y,r.fillColor)}}}class xa extends ka{draw(t,s){J.draw(t),Te.draw(t);const i=R.getAll();let r=i.length;if(r>0){let a=r-1;const n=J.getAll(),o=n.length,c=o-1;do{const h=i[a];let p=!1,m=c;if(o>0)do{const C=n[m];if(h.hasCollided(C)===!0){let E;switch(p=!0,C.type){case"gravityField":C.orbitParticle(h);break;default:r--,R.remove(h),E=h.position,this.createDevice(E.x,E.y,h.fillColor,h.multiplier),this.createPoints(E.x-55,E.y-35,h.value)}break}}while(m--);p===!1&&h.move(),h.draw(t)}while(a--)}return y.graphics==="high"&&Ae.draw(t),this.isComplete(r)}}class Ca extends ia{constructor(){super(...arguments);d(this,"controller",new xa);d(this,"levels",[[1,28,40,40,1,65,"StartupPrompt","first"],[1,40,50,50,1,62,!1],[1,45,50,50,1,67,!1],[1,53,57,57,1,60,!1],[1,45,50,{Particle:49,PulseParticle:1},1,61,"PulseParticlePrompt"],[1,32,40,{Particle:39,PulseParticle:1},1,60,!1],[[1,1],29,35,{Particle:34,PulseParticle:1},1,62,"GravityFieldPrompt"],[[1,1],32,39,{Particle:38,PulseParticle:1},1,61,!1],[[1,1],28,35,{Particle:34,PulseParticle:1},1,60,!1],[[1,1],55,60,{Particle:59,PulseParticle:1},1,56,!1],[[2,1],72,80,{Particle:79,PulseParticle:1},1,56,"AddTwoPrompt","second"],[[2,1],63,70,{Particle:69,PulseParticle:1},1,56,!1],[[2,1],64,70,{Particle:69,PulseParticle:1},1,54,!1],[[1,2],67,72,{Particle:71,PulseParticle:1},1,53,!1],[[2,1],52,60,{Particle:59,PulseParticle:1},1,52,!1],[[2,1],60,65,{Particle:63,PulseParticle:2},1,52,!1],[[1,2],48,56,{Particle:54,PulseParticle:3},1,50,!1],[[2,1],46,52,{Particle:50,PulseParticle:2},1,50,!1],[[1,2],50,55,{Particle:52,PulseParticle:3},1,50,!1],[[2,1],30,48,{Particle:45,PulseParticle:3},1,48,!1],[[3,1],40,50,{Particle:48,PulseParticle:2},1,50,"AddThreePrompt","third"],[[2,2],40,55,{Particle:53,PulseParticle:2},1,49,!1],[[3,1],58,63,{Particle:61,PulseParticle:2},1,49,!1],[[1,3],62,68,{Particle:66,PulseParticle:2},1,49,!1],[[2,2],65,70,{Particle:68,PulseParticle:2},1,47,!1],[[3,1],25,38,{Particle:36,PulseParticle:2},1,47,!1],[[3,1],40,48,{Particle:46,PulseParticle:2},1,47,!1],[[2,2],32,45,{Particle:43,PulseParticle:2},1,45,!1],[[3,1],50,55,{Particle:53,PulseParticle:2},1,45,!1],[[4,1],52,60,{Particle:58,PulseParticle:2},1,45,"AddFourPrompt"],[[3,2],52,65,{Particle:63,PulseParticle:2},1,42,!1],[[3,2],60,68,{Particle:66,PulseParticle:2},1,42,!1],[[4,1],70,79,{Particle:77,PulseParticle:2},1,42,!1],[[4,1],56,64,{Particle:62,PulseParticle:2},1,44,!1],[[2,3],48,55,{Particle:53,PulseParticle:2},1,44,!1],[[4,1],46,54,{Particle:52,PulseParticle:2},1,44,!1],[[3,2],62,68,{Particle:66,PulseParticle:2},1,42,!1],[[3,2],46,50,{Particle:48,PulseParticle:2},1,42,!1],[[3,2],50,55,{Particle:53,PulseParticle:2},1,42,!1],[[4,1],44,48,{Particle:46,PulseParticle:2},1,40,!1]])}createLevel(s,i,r){const a=new Dt(s,i[0],i[1],i[2],i[3],i[4],i[5],i[6],r);return a.setup(),a}}class La{constructor(){this.canvas=null,this.ctx=null}setup(){this.createBufferCanvas()}createBufferCanvas(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.resize()}resize(t){const s=this.canvas;s.width=t.width,s.height=t.height}}const Aa=1e3,zt=60;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,Aa/zt)};const Ta=window.requestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||function(e){window.clearTimeout(e)};const Ke=(e,t)=>({width:e,height:t}),Ea=(e,t,s)=>({x:e,y:t,status:s});class Oa{constructor(t,s,i){d(this,"canvasBoundBox",null);d(this,"scaleRatio",1);this.game=i,this.targetSize=Ke(t,s),this.size=Ke(0,0),this.fps=zt,this.canvas=null,this.context=null,this.levelController=null,this.mouse=Ea(0,0,"up"),this.animationId=null,this.buffer=null}setup(){this.drawBind=this.draw.bind(this),this.setupEvents()}setCanvas(t){this.canvas=t,this.context=t.getContext("2d")}setupEvents(){this.setupMouse(),this.resize(),window.addEventListener("resize",this.resize.bind(this),!1);const t=this.mouseDown.bind(this),s=this.canvas;this.addEvent=()=>{s.addEventListener("mousedown",t,!1),s.addEventListener("touchstart",t,!1)},this.removeEvent=()=>{s.removeEventListener("mousedown",t,!1),s.removeEventListener("touchstart",t,!1)}}setupMouse(){const t=document,s=this.canvas,i=this.mousePosition.bind(this),r=this.mouseUp.bind(this);s.addEventListener("mousemove",i),t.addEventListener("mouseup",r),s.addEventListener("touchmove",i),t.addEventListener("touchend",r)}interact(t,s){this.levelController.interact(t,s)}getInteractPositions(t){const s=this.scaleRatio,i=this.canvasBoundBox,r=(o,c)=>({x:parseInt(String((o-i.left)*s)),y:parseInt(String((c-i.top)*s))}),a=[],n=t.touches;if(n&&n.length){const o=n[n.length-1];a.push(r(o.pageX,o.pageY))}else{let o,c;o=t.x||t.clientX,c=t.y||t.clientY,a.push(r(o,c))}return a}getEventPosition(t){let s,i;const r=t.touches;if(r&&r.length){const p=r[0];s=p.pageX,i=p.pageY}else s=t.x||t.clientX,i=t.y||t.clientY;const a=this.scaleRatio,n=this.canvasBoundBox,o=parseInt(String((s-n.left)*a)),c=parseInt(String((i-n.top)*a));let h=this.mouse;h.x=o,h.y=c}mousePosition(t){this.getEventPosition(t)}mouseDown(t){t.preventDefault(),t.stopPropagation();const s=this.getInteractPositions(t);for(let i=0,r=s.length;i<r;i++){let a=s[i];this.interact(a.x,a.y)}this.mouse.status="down"}mouseUp(){this.mouse.status="up"}getContainerSize(){const t={width:0,height:0},s=this.canvas.parentNode;if(s){const i=s.style,r=i.borderLeftWidth+i.borderRightWidth,a=i.paddingLeft+i.paddingRight,n=i.borderTopWidth+i.borderBottomWidth,o=i.paddingTop+i.paddingBottom;let c=0,h=0,p=0;i.boxSizing!=="border-box"?(h=s.clientWidth-(r+a),p=s.clientHeight-(n+o)):(h=s.clientWidth,p=s.clientHeight),t.width=h>c?h:c,t.height=p}return t}resize(){const t=this.getContainerSize();if(t.width>0){const s=this.canvas,i=this.targetSize;s.width=i.width,s.height=i.height,this.size={width:s.width,height:s.height},this.scale(t,s),this.canvasBoundBox=s.getBoundingClientRect()}}scale(t,s){const i=s.height,r=s.width,a=t.width,n=t.height,o=a/r,c=n/i,h=Math.min(o,c);s.style.width=r*h+"px",s.style.height=i*h+"px",this.scaleRatio=this.size.width/parseInt(s.style.width)}draw(){const t=this.context,s=this.size;t.clearRect(0,0,s.width,s.height),this.levelController.draw(t,this)===!0?(this.stopDraw(),this.game.levelSummary()):this.animationId=Ta(this.drawBind)}renderFromBuffer(t,s,i){const r=this.context;r.clearRect(0,0,t,s),r.drawImage(i.canvas,0,0)}startDraw(){typeof this.animationId<"u"&&(this.stopDraw(),this.draw())}stopDraw(){window.cancelAnimationFrame(this.animationId),this.animationId=null}setupBuffer(){this.buffer=new La,this.buffer.setup()}}const Ba=()=>{try{return window.self!==window.top}catch{return!0}},Da=()=>{if(!Ba()&&!(!screen||!screen.orientation||typeof screen.orientation.lock!="function"))try{screen.orientation.lock("landscape").then(()=>{console.log("Orientation locked successfully.")}).catch(e=>{console.log(`Orientation lock not available: ${e.message}`)})}catch{console.log("Orientation lock not supported in this context")}};class ja{constructor(t,s,i){this.stage=new Oa(t,s,this),this.app=i,S.setGame(this),Le.setGame(this),Le.setup()}getCurrentLevel(){return S.currentLevel}setCanvas(t){this.stage.setCanvas(t)}setup(){this.setupLevels()}setupStage(){this.stage.setup()}setupLevelPacks(){[new Ca(this)].forEach(s=>{S.addLevelPack(s)})}setStageLevelController(t){this.stage.levelController=t}setupLevels(){this.setupLevelPacks(),S.setup()}startGame(){Da(),S.selectPrimaryLevel(),this.app.navigate("/play"),y.song="play-loop.mp3"}play(){this.app.navigate("/"),this.app.navigate("/play"),y.song="play-loop.mp3",this.startStage()}resume(){this.app.navigate("/play"),this.startStage(),y.song="play-loop.mp3"}pause(){this.stopStage()}retryLevel(){S.retryLevel(),this.play()}selectLevel(t){S.selectLevel(t),this.play()}nextLevel(){S.selectNextLevel(),this.play()}previousLevel(){S.selectPreviousLevel(),this.play()}resetCurrentLevel(){this.retryLevel()}levelSummary(){this.stopStage(),y.song="summary-slow-loop.mp3",this.app.navigate("/play/level-summary")}startDraw(){this.stage.startDraw()}stopDraw(){this.stage.stopDraw()}startStage(){const t=this.stage;t.addEvent(),t.startDraw()}stopStage(){const t=this.stage;t.removeEvent(),t.stopDraw()}}class Ia{constructor(){d(this,"router",null);d(this,"appShell",null);this.setupOrientationPrompt(),this.setupService(),this.setupRouter(),this.setupAppShell()}setupService(){const t=window.location.protocol.replace(":","");if(!("serviceWorker"in navigator)||t==="http")return;navigator.serviceWorker.register("./sw.js",{scope:"./"}).then(i=>{})}setupRouter(){this.router=M;const{baseUrl:t,title:s}=ce.router;M.setup(t,s);const i=window.location.pathname,r=i==="/"||i===t||i==="";console.log("Router setup - Current path:",i,"Is root:",r),r&&M.navigate("/")}navigate(t,s,i){this.router.navigate(t,s,i)}setupGame(){const t=ce.size,s=new ja(t.width,t.height,this);return s.setup(),s}setupAppShell(){const t=Gr({game:this.setupGame()});k.render(t,document.body)}isInIframe(){try{return window.self!==window.top}catch{return!0}}setupOrientationPrompt(){if(this.isInIframe())return;const t=nr();window.matchMedia("(orientation: portrait)").matches&&t.open(),window.matchMedia("(orientation: portrait)").addEventListener("change",s=>{if(s.matches){t.open();return}t.close()})}}globalThis.app=new Ia;
